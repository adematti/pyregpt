#ifndef _REGPT_GAMMA2D_
#define _REGPT_GAMMA2D_
#define NPOWERS 20
#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "define.h"
#include "common.h"
#include "kernels.h"

histo_t kernel_Gamma2d_exact(histo_t k1_,histo_t k2_,histo_t k3_,histo_t q_)
{
	histo_t k1[NPOWERS],k2[NPOWERS],k3[NPOWERS],q[NPOWERS];
	powers(k1_,k1,NPOWERS); powers(k2_,k2,NPOWERS); powers(k3_,k3,NPOWERS); powers(q_,q,NPOWERS);
	
	/*size_t i;
	for (i=2;i<NPOWERS;i++) {
		if (my_abs(k1[i])>1e5) printf("%.3f ",k1[i]);
	}*/ 
	histo_t kernel1 = (M_PI*(15.*k1[6]*k2[6]*k3[4]*
		(3.*(k1[2] - k2[2])*(k1[2] - k2[2])*
		(13.*k1[4] - 4.*k1[2]*k2[2] + 13.*k2[4]) - 
		(k1[2] + k2[2])*
		(805.*k1[4] - 2306.*k1[2]*k2[2] + 
		805.*k2[4])*k3[2] + 
		(377.*k1[4] + 940.*k1[2]*k2[2] + 377.*k2[4])*k3[4] + 
		361.*(k1[2] + k2[2])*k3[6] + 28.*k3[8])/q[4] - 
		10.*k1[6]*k2[6]*k3[4]*
		(3.*(k1[2] + k2[2])*
		(911.*k1[4] - 1570.*k1[2]*k2[2] + 911.*k2[4]) + 
		(-22261.*k1[4] + 45566.*k1[2]*k2[2] - 
		22261.*k2[4])*k3[2] + 
		12037.*(k1[2] + k2[2])*k3[4] + 6891.*k3[6])/q[2] + 
		k1[4]*k2[4]*k3[2]*
		(3150.*k1[2]*k2[2]*(k1[2] - k2[2])*(k1[2] - k2[2])*(k1[2] + k2[2]) + 
		3*(19475.*k1[8] - 139742.*k1[6]*k2[2] + 
		246974.*k1[4]*k2[4] - 139742.*k1[2]*k2[6] + 
		19475.*k2[8])*k3[2] - 2.*(k1[2] + k2[2])*
		(53220.*k1[4] - 178337.*k1[2]*k2[2] + 
		53220.*k2[4])*k3[4]
		+ (38925.*k1[4] + 9532.*k1[2]*k2[2] + 38925.*k2[4])*
		k3[6] + 9090.*(k1[2] + k2[2])*k3[8]) - 
		15.*k1[2]*k2[2]*(189.*k1[4]*k2[4]*(k1[2] - k2[2])*(k1[2] - k2[2])*
		(k1[2] + k2[2]) - 
		84.*k1[4]*k2[4]*(43.*k1[4] - 80.*k1[2]*k2[2] + 
		43.*k2[4])*k3[2] + (k1[2] + k2[2])*
		(1949.*k1[8] - 10643.*k1[6]*k2[2] + 
		20573.*k1[4]*k2[4] - 
		10643.*k1[2]*k2[6] + 1949.*k2[8])*k3[4] + 
		2.*(-1959.*k1[8] + 3283.*k1[6]*k2[2] + 
		1907.*k1[4]*k2[4] + 3283.*k1[2]*k2[6] - 
		1959.*k2[8])*k3[6] + 3.*(k1[2] + k2[2])*
		(663.*k1[4] - 811.*k1[2]*k2[2] + 663.*k2[4])*k3[8] - 
		20.*(k1[4] + k2[4])*k3[10])*q[2] + 
		45.*(-252.*k1[6]*k2[6]*(k1[2] - k2[2])*(k1[2] - k2[2]) + 
		168.*k1[6]*k2[6]*(k1[2] + k2[2])*k3[2] + 
		(55.*k1[12] - 285.*k1[10]*k2[2] + 157.*k1[8]*k2[4] + 
		230.*k1[6]*k2[6] + 157.*k1[4]*k2[8] - 
		285.*k1[2]*k2[10] + 55.*k2[12])*k3[4] - 
		3.*(k1[2] + k2[2])*
		(55.*k1[8] - 201.*k1[6]*k2[2] + 156.*k1[4]*k2[4] - 
		201.*k1[2]*k2[6] + 55.*k2[8])*k3[6] + 
		3.*(55.*k1[8] - 51.*k1[6]*k2[2] - 51.*k1[2]*k2[6] + 
		55.*k2[8])*k3[8] - 55.*(k1[6] + k2[6])*k3[10])*q[4]))/
		(1.55232e6*k1[8]*k2[8]*k3[4]);

	histo_t kernel2 = - (M_PI*(k1[1]/q[1] - 1.)*(k1[1]/q[1] - 1.)*(k1[1]/q[1] + 1.)*(k1[1]/q[1] + 1.)*
		(39.*k1[12] + 165.*my_pow(k2[2] - k3[2],3)*q[6] - 
		k1[10]*(582.*k2[2] + 791.*k3[2] + 1947.*q[2]) - 
		3.*k1[2]*(k2[1] - k3[1])*(k2[1] + k3[1])*q[4]*
		(558.*k2[4] - 473.*k2[2]*k3[2] - 85.*k3[4] + 
		3.*(95.*k2[2] - 51.*k3[2])*q[2]) + 
		k1[6]*(492.*k2[6] - 633.*k2[4]*k3[2] + 
		390.*k2[2]*k3[4] + 151.*k3[6] + 
		(-6465.*k2[4] + 758.*k2[2]*k3[2] + 179.*k3[4])*
		q[2] - 3.*(2428.*k2[2] + 371.*k3[2])*q[4] + 
		219.*q[6]) + k1[8]*(51.*k2[4] + 601.*k3[4] + 
		1787.*k3[2]*q[2] + 1689.*q[4] + 
		k2[2]*(2120.*k3[2] + 6891.*q[2])) + k1[4]*q[2]*
		(1017.*k2[6] + 269.*k3[6] - 321.*k3[4]*q[2] + 
		405.*k3[2]*q[4] + k2[4]*(-1677.*k3[2] + 7269.*q[2]) + 
		k2[2]*(391.*k3[4] - 4376.*k3[2]*q[2] + 471.*q[4])))*
		LFunc(k1[1],q[1]))/(413952.*k1[9]*k2[2]*q[1]);

	histo_t kernel3 = - (M_PI*(k2[1]/q[1] - 1.)*(k2[1]/q[1] - 1.)*(k2[1]/q[1] + 1.)*(k2[1]/q[1] + 1.)*
		(k2[6]*(492.*k1[6] + 39.*k2[6] - 791.*k2[4]*k3[2] + 
		601.*k2[2]*k3[4] + 151.*k3[6] + 
		k1[4]*(51.*k2[2] - 633.*k3[2]) + 
		k1[2]*(-582.*k2[4] + 2120.*k2[2]*k3[2] + 390.*k3[4])) + 
		k2[4]*(1017.*k1[6] - 1947.*k2[6] + 1787.*k2[4]*k3[2] + 
		179.*k2[2]*k3[4] + 269.*k3[6] - 
		3.*k1[4]*(2155.*k2[2] + 559.*k3[2]) + k1[2]*
		(6891.*k2[4] + 758.*k2[2]*k3[2] + 391.*k3[4]))*q[2] - 
		k2[2]*(3.*(k1[1] - k2[1])*(k1[1] + k2[1])*
		(558.*k1[4] - 1865.*k1[2]*k2[2] + 563.*k2[4]) + 
		(-3093.*k1[4] + 4376.*k1[2]*k2[2] + 1113.*k2[4])*k3[2]+ 
		3.*(388.*k1[2] + 107.*k2[2])*k3[4] + 255.*k3[6])*q[4]
		+3.*(55.*k1[6] - 15.*k1[4]*(19.*k2[2] + 11.*k3[2])+ 
		(k2[1] - k3[1])*(k2[1] + k3[1])*
		(73.*k2[4] + 208.*k2[2]*k3[2] + 55.*k3[4]) + 
		k1[2]*(157.*k2[4] + 438.*k2[2]*k3[2] + 165.*k3[4]))*
		q[6])* LFunc(k2[1],q[1]))/(413952.*k1[2]*k2[9]*q[1]); 

	histo_t kernel4 = (M_PI*(2.*my_pow(k3[1]/q[1],4) + 7.*(k3[1]/q[1])*(k3[1]/q[1]) - 9.)*
		(k3[4]*(k1[6] - 9.*k1[4]*k2[2] - 9.*k1[2]*k2[4] + k2[6] + 
		16.*(k1[2] - k2[2])*(k1[2] - k2[2])*k3[2] - 
		15.*(k1[2] + k2[2])*k3[4] - 2.*k3[6]) + 2.*k3[2]*
		((k1[2] - k2[2])*(k1[2] - k2[2])*(k1[2] + k2[2]) - 
		4.*(7.*k1[4] - 17.*k1[2]*k2[2] + 7.*k2[4])*k3[2] + 
		23.*(k1[2] + k2[2])*k3[4])*q[2] - 
		(3.*(k1[2] - k2[2])*(k1[2] - k2[2])*(k1[2] + k2[2]) - 
		4.*(13.*k1[4] - 24.*k1[2]*k2[2] + 13.*k2[4])*k3[2] + 
		47.*(k1[2] + k2[2])*k3[4] + 2.*k3[6])*q[4] + 
		4.*(-3.*(k1[2] - k2[2])*(k1[2] - k2[2]) + 2.*(k1[2] + k2[2])*k3[2] + 
		k3[4])*q[6])*LFunc(k3[1],q[1]))/(59136.*k1[2]*k2[2]*k3[5]*q[1]);

	histo_t kernel5 = (3.*k3[3]*M_PI*(k1[2] - q[2])*(k1[2] - q[2])*(-k2[2] + q[2])*(-k2[2] + q[2])*
		WFunc(k1[1],k2[1],k3[1],q[1]))/(4312.*k1[2]*k2[2]*q[5]*
		my_sqrt(k1[2]*k2[2] - (k1[2] + k2[2] - k3[2])*q[2] + q[4])) + 
		(k2[1]*M_PI*(k1[2] - q[2])*(k1[2] - q[2])*(2.*k3[4] + 
		7.*k3[2]*q[2] - 9.*q[4])*WFunc(k1[1],k3[1],k2[1],q[1]))/
		(7392.*k1[2]*q[5]*my_sqrt(k1[2]*k3[2] - 
		(k1[2] - k2[2] + k3[2])*q[2] + q[4])) + 
		(k1[1]*M_PI*(k2[2] - q[2])*(k2[2] - q[2])*(2.*k3[4] + 7.*k3[2]*q[2] - 
		9.*q[4])*WFunc(k2[1],k3[1],k1[1],q[1]))/
		(7392.*k2[2]*q[5]*my_sqrt(k1[2]*q[2] + 
		(k2[1] - q[1])*(k3[1] - q[1])*(k2[1] + q[1])*(k3[1] + q[1])));

	//printf("%.3f %.3f %.3f %.3f %.3f  ",kernel1,kernel2,kernel3,kernel4,kernel5);
	//if (isnan(kernel1 + kernel2 + kernel3 + kernel4 + kernel5)) printf("%.3f %.3f %.3f %.3f %.3f\n",kernel1,kernel2,kernel3,kernel4,kernel5);
	//if (isnan(kernel1 + kernel2 + kernel3 + kernel4 + kernel5)) printf("%.3f %.3f %.3f\n",WFunc(k1[1],k2[1],k3[1],q[1]),WFunc(k1[1],k3[1],k2[1],q[1]),WFunc(k2[1],k3[1],k1[1],q[1]));
	return kernel1 + kernel2 + kernel3 + kernel4 + kernel5;
}

histo_t kernel_Gamma2d_iso(histo_t k1_,histo_t k2_,histo_t k3_,histo_t q_)
{
	histo_t k1[NPOWERS],k3[NPOWERS],q[NPOWERS],eps[NPOWERS];
	powers(k1_,k1,NPOWERS); powers(k3_,k3,NPOWERS); powers(q_,q,NPOWERS); powers(k2_/k1_ - 1.,eps,NPOWERS);
	
	return (M_PI*((-60.*eps[1]*(k1[1] - q[1])*q[1]*(k1[1] + q[1])*(165.*k3[6]*q[6] + 
		k1[10]*(-696.*k3[2] + 504.*q[2]) - k1[8]*(991.*k3[4] + 
		868.*k3[2]*q[2]) + k1[6]*(-151.*k3[6] - 
		570.*k3[4]*q[2] + 2396.*k3[2]*q[4]) + 
		k1[4]*(-269.*k3[6]*q[2] + 1485.*k3[4]*q[4] - 
		1224.*k3[2]*q[6]) + 3.*k1[2]*(85.*k3[6]*q[4] - 
		12.*k3[4]*q[6])))/k1[10] + 
		8.*q[1]*((420.*eps[1]*(k1[2] - q[2])*(k1[2] - q[2])*(2.*k3[4] + 
		7.*k3[2]*q[2] - 9.*q[4]))/(k1[2]*k3[2] - k3[2]*q[2] + 
		q[4]) + (2160.*eps[1]*k3[4]*my_pow(-k1[2] + q[2],3))/
		(k1[2]*(k1[4] - 2.*k1[2]*q[2] + k3[2]*q[2] + q[4])) + 
		(-420.*eps[1]*k1[12]*k3[2]*(k1[2] - q[2])*(2.*k3[4] + 
		7.*k3[2]*q[2] - 9.*q[4]) + 
		(k1[2]*k3[2] - k3[2]*q[2] + q[4])*(2475.*(-1. + 
		5.*eps[1])*k3[8]*q[8] + 360.*(1 + eps[1])*k1[12]*k3[2]*
		(29.*k3[2] - 21.*q[2]) - 
		60.*(-1. + 4.*eps[1])*k1[2]*k3[6]*q[6]*(5.*k3[2] + 
		9.*q[2]) - 45.*(-1. + 3.*eps[1])*k1[4]*k3[4]*q[4]*
		(202.*k3[4] - 515.*k3[2]*q[2] + 408.*q[4]) + 
		15.*k1[10]*(847.*k3[6] - 348.*k3[4]*q[2] + 
		644.*k3[2]*q[4] + 252.*q[6]) - 
		(-1. + 2.*eps[1])*k1[6]*k3[2]*(210.*k3[8] - 
		34455.*k3[6]*q[2] + 43691.*k3[4]*q[4] - 
		68325.*k3[2]*q[6] + 1890.*q[8]) - 
		(-1. + eps[1])*k1[8]*(5415.*k3[8] - 120370.*k3[6]*q[2] + 
		143794.*k3[4]*q[4] - 47775.*k3[2]*q[6] + 7560.*q[8])))/
		(k1[10]*k3[2]*(k1[2]*k3[2] - k3[2]*q[2] + q[4]))) + 
		(15.*(165.*(2. - 11.*eps[1])*k3[6]*q[10] - 
		24.*(2. + 3.*eps[1])*k1[14]*(29.*k3[2] - 21.*q[2]) + 
		3.*(-2. + 9.*eps[1])*k1[2]*k3[4]*q[8]*(25.*k3[2] + 
		12.*q[2]) - (-2. + 3.*eps[1])*k1[8]*k3[2]*q[2]*
		(33.*k3[4] + 1634.*k3[2]*q[2] - 6884.*q[4]) - 
		(2. + eps[1])*k1[12]*(991.*k3[4] - 524.*k3[2]*q[2] + 
		1008.*q[4]) + 
		(-2. + 7.*eps[1])*k1[4]*k3[2]*q[6]*(614.*k3[4] - 
		1557.*k3[2]*q[2] + 1224.*q[4]) - 
		2.*(-2. + 5.*eps[1])*k1[6]*k3[2]*q[4]*(321.*k3[4] - 
		1788.*k3[2]*q[2] + 2422.*q[4]) + 
		(-2. + eps[1])*k1[10]*(151.*k3[6] - 1412.*k3[4]*q[2] - 
		3436.*k3[2]*q[4] - 504.*q[6]))*
		2.*my_log(my_abs((k1[1] + q[1])/(k1[1] - q[1]))))/k1[11] - 
		(210.*(2.*k3[4] + 7.*k3[2]*q[2] - 9.*q[4])*
		(8.*(1 + eps[1])*k1[6]*k3[2] - 4.*k1[4]*(3.*k3[2]*q[2] + 
		q[4]) - (-1. + eps[1])*k1[2]*(15.*k3[6] - 46.*k3[4]*q[2] + 
		47.*k3[2]*q[4] - 8.*q[6]) - (-1. + 2.*eps[1])*k3[2]*
		(k3[6] + k3[2]*q[4] - 2.*q[6]))*
		2.*my_log(my_abs((k3[1] + q[1])/(k3[1] - q[1]))))/(k1[4]*k3[3]) + 
		(840.*(-k1[1] + q[1])*(k1[1] + q[1])*(-2.*k3[4] - 7.*k3[2]*q[2] + 
		9.*q[4])*(2.*(1 + eps[1])*k1[4]*k3[2] + 
		(-2. + eps[1])*q[4]*(-k3[2] + q[2]) + 
		k1[2]*q[2]*(-((4. + eps[1])*k3[2]) + (2. + 3*eps[1])*q[2]))*
		my_log((-(k3[2]*q[2]) + q[4] + k1[2]*(k3[2] + q[2]) + 
		2*k1[1]*q[1]*my_sqrt(k1[2]*k3[2] - k3[2]*q[2] + q[4]))/
		(-(k3[2]*q[2]) + q[4] + k1[2]*(k3[2] + q[2]) - 
		2.*k1[1]*q[1]*my_sqrt(k1[2]*k3[2] - k3[2]*q[2] + q[4]))))/
		(k1[1]*my_pow(k1[2]*k3[2] - k3[2]*q[2] + q[4],1.5)) + 
		(4320.*k3[3]*my_pow(k1[2] - q[2],3)*
		((1. + eps[1])*k1[6] - 3.*k1[4]*q[2] + 
		(-1. + 2.*eps[1])*q[4]*(k3[2] + q[2]) + 
		k1[2]*q[2]*((1. + 2.*eps[1])*k3[2] - 
		3.*(-1. + eps[1])*q[2]))*
		my_log(-((4.*k3[2]*q[2] + 2.*(k1[2] - q[2])*(k1[2] - q[2]) + 
		4.*k3[1]*q[1]*my_sqrt(k1[4] + (-2.*k1[2] + k3[2])*q[2] + q[4]))/
		(-4.*k3[2]*q[2] - 2.*(k1[2] - q[2])*(k1[2] - q[2]) + 4.*k3[1]*q[1]*
		my_sqrt(k1[4] + (-2.*k1[2] + k3[2])*q[2] + q[4])))))/
		(k1[4]*my_pow(k1[4] - 2.*k1[2]*q[2] + k3[2]*q[2] + q[4],1.5))))/
		(6.20928e6*q[5]);
}

histo_t kernel_Gamma2d_highk(histo_t k1_,histo_t k2_,histo_t k3_,histo_t q_)
{
	histo_t k1[NPOWERS],k2[NPOWERS],k3[NPOWERS],q[NPOWERS];
	powers(k1_,k1,NPOWERS); powers(k2_,k2,NPOWERS); powers(k3_,k3,NPOWERS); powers(q_,q,NPOWERS);

	return (M_PI*(8085.*k1[4]*k2[4]*k3[6]*(5.*(k1[2] - k2[2])*(k1[2] - k2[2]) - 
		3.*(k1[2] + k2[2])*k3[2] - 2.*k3[4])/q[2] + 
		7.*k1[2]*k2[2]*k3[2]*(28.*my_pow(k1[2] - 
		k2[2],4)*(k1[2] + k2[2]) + 3.*(k1[2] - k2[2])*(k1[2] - k2[2])*
		(1094.*k1[4] - 6321.*k1[2]*k2[2] + 1094.*k2[4])*k3[2] - 
		6.*(k1[2] + k2[2])*(988.*k1[4] - 3189.*k1[2]*k2[2] + 
		988.*k2[4])*k3[4] + (1970.*k1[4] + 741.*k1[2]*k2[2] + 
		1970.*k2[4])*k3[6] + 
		576.*(k1[2] + k2[2])*k3[8] + 72.*k3[10]) + 
		(-14.*my_pow((k1[1] - k2[1])*(k1[1] + k2[1]),4)*(k1[2] + k2[2])*
		(12.*k1[4] - 55.*k1[2]*k2[2] + 12.*k2[4]) + 
		7.*(28.*k1[12] + 4005.*k1[8]*k2[4] - 
		8066.*k1[6]*k2[6] + 4005.*k1[4]*k2[8] + 
		28.*k2[12])*k3[2] - 
		6.*(k1[2] + k2[2])*(2999.*k1[8] - 16730.*k1[6]*k2[2] + 
		31403.*k1[4]*k2[4] - 16730.*k1[2]*k2[6] + 
		2999.*k2[8])*k3[4] + 
		(34488.*k1[8] - 51644.*k1[6]*k2[2] - 
		33313.*k1[4]*k2[4] - 51644.*k1[2]*k2[6] + 
		34488.*k2[8])*k3[6] - 
		2.*(k1[2] + k2[2])*(7649.*k1[4] - 8021.*k1[2]*k2[2] + 
		7649.*k2[4])*k3[8] - 1296.*(k1[4] + k2[4])*k3[10] + 
		504.*(k1[2] + k2[2])*k3[12] - 
		432.*k3[14])*q[2]))/(339570.*k1[6]*k2[6]*k3[4]);
}

histo_t kernel_Gamma2d_lowk(histo_t k1_,histo_t k2_,histo_t k3_,histo_t q_)
{
	histo_t k1[NPOWERS],k2[NPOWERS],k3[NPOWERS],q[NPOWERS];
	powers(k1_,k1,NPOWERS); powers(k2_,k2,NPOWERS); powers(k3_,k3,NPOWERS); powers(q_,q,NPOWERS);

	return (M_PI*(2426.*k1[8] - 
		4.*k1[6]*(3110.*k2[2] + 2087.*k3[2] + 3006.*q[2]) + 
		k1[2]*(2.*(-6220.*k2[6] + 7198.*k2[4]*k3[2] + 
		5449.*k2[2]*k3[4] + 1073.*k3[6]) + 
		(12024.*k2[4] - 76684.*k2[2]*k3[2] - 
		20085.*k3[4])*q[2]) + k1[4]*(20028.*k2[4] + 
		3363.*k3[4] + 44518.*k3[2]*q[2] + 
		4.*k2[2]*(3599.*k3[2] + 3006.*q[2])) + 
		(k2[1] - k3[1])*(k2[1] + k3[1])*(2426.*k2[6] - 413.*k3[6] + 
		12409.*k3[4]*q[2] - 18.*k2[4]*(329.*k3[2] + 
		668.*q[2]) + 
		k2[2]*(-2559.*k3[4] + 32494.*k3[2]*q[2]))))/
		(339570.*k1[2]*k2[2]*q[4]);	
}


histo_t kernel_Gamma2d_elongate(histo_t k1_,histo_t k2_,histo_t k3_,histo_t q_)
{
	histo_t k_,eps_;
	if (k1_>k2_) {
		k_ = k1_;
		eps_ = k2_ / k1_;
	}
	else {
		k_ = k2_;
		eps_ = k1_ / k2_;
	}
	histo_t k1[NPOWERS],k2[NPOWERS],k3[NPOWERS],q[NPOWERS],k[NPOWERS],eps[NPOWERS];
	powers(k1_,k1,NPOWERS); powers(k2_,k2,NPOWERS); powers(k3_,k3,NPOWERS); powers(q_,q,NPOWERS);  powers(k_,k,NPOWERS); powers(eps_,eps,NPOWERS);

	return (M_PI*((4.*k[16]*q[1]*(42100.*k[6] + 13841.*k3[6] - 
		10132.*k3[4]*q[2] - 405090.*k3[2]*q[4] - 139020.*q[6] - 
		3.*k[4]*(13429.*k3[2] + 512318.*q[2]) + 
		k[2]*(54346.*k3[4] + 144594.*k3[2]*q[2] - 
		2024631.*q[4])))/7. - 
		(4.*k[10]*q[1]*(1350.*k[12]*k3[4] - 7425.*k3[8]*q[8] - 
		15.*k[10]*(1501.*k3[6] + 1318.*k3[4]*q[2] - 
		210.*k3[2]*q[4] + 189.*q[6]) - 
		2.*k[8]*(7050.*k3[8] - 227830.*k3[6]*q[2] + 
		370461.*k3[4]*q[4] - 50400.*k3[2]*q[6] + 11340.*q[8]) + 
		k[6]*(-5415.*k3[10] + 120370.*k3[8]*q[2] - 
		250234.*k3[6]*q[4] + 148950.*k3[4]*q[6] - 
		7560.*k3[2]*q[8]) - 15.*k[4]*(2595.*k3[8]*q[4] - 
		6566.*k3[6]*q[6] + 471.*k3[4]*q[8]) + 
		135.*k[2]*(221.*k3[8]*q[6] - 146.*k3[6]*q[8]))
		)/k3[4] - 15.*k[9]*(k[1] - q[1])*(k[1] - q[1])*(k[1] + q[1])*(k[1] + q[1])*
		(-582.*k[10] + 495.*k3[4]*q[6] + k[8]*(2120.*k3[2] + 
		6891.*q[2]) + k[6]*(390.*k3[4] + 758.*k3[2]*q[2] - 
		7284.*q[4]) + k[4]*(391.*k3[4]*q[2] - 
		4376.*k3[2]*q[4] + 471.*q[6]) - 
		6.*k[2]*(194.*k3[4]*q[4] - 
		219*k3[2]*q[6]))*2.*my_log(my_abs((k[1] + q[1])/(k[1] - q[1]))) - 
		(105.*k[16]*(2.*k3[4] + 7.*k3[2]*q[2] - 9.*q[4])*
		(15.*k3[8] - 46.*k3[6]*q[2] + 47.*k3[4]*q[4] - 
		8.*k3[2]*q[6] + k[4]*(9.*k3[4] + 2.*k3[2]*q[2] - 
		3.*q[4]) + 8.*k[2]*(4.*k3[6] - 17.*k3[4]*q[2] + 
		12.*k3[2]*q[4] - 3.*q[6]))*
		2.*my_log(my_abs((k3[1] + q[1])/(k3[1] - q[1]))))/k3[5] + 
		(420.*k[19]*q[3]*(-k3[2] + q[2])*(2.*k3[2] + 9.*q[2])*
		(-4.*k[1]*my_sqrt(q[2]*(k[2] - k3[2] + q[2])) + 
		q[1]*(4.*k[2] - 3.*k3[2] + 3.*q[2])*
		my_log((2.*k[2]*q[1] - k3[2]*q[1] + q[3] + 
		2.*k[1]*my_sqrt(q[2]*(k[2] - k3[2] + q[2])))/
		(2.*k[2]*q[1] - k3[2]*q[1] + q[3] - 2.*k[1]*my_sqrt(q[2]*(k[2] - 
		k3[2] + q[2]))))))/my_pow(q[2]*(k[2] - k3[2] + q[2]),1.5)
		+ (2160.*k[16]*k3[3]*q[3]*(k[2] - q[2])*(k[2] - q[2])*
		(4.*k3[1]*my_sqrt(q[2]*(-k[2] + k3[2] + q[2])) + 
		q[1]*(3.*k[2] - 4.*k3[2] - 3.*q[2])*my_log(-((-(k[2]*q[1]) + 
		2.*k3[2]*q[1] + q[3] + 2.*k3[1]*my_sqrt(q[2]*(-k[2] + k3[2] + 
		q[2])))/(k[2]*q[1] - 2.*k3[2]*q[1] - q[3] + 
		2.*k3[1]*my_sqrt(q[2]*(-k[2] + k3[2] + q[2])))))))/
		my_pow(q[2]*(-k[2] + k3[2] + q[2]),1.5) + 
		((4.*k[14]*q[3]*(218739.*k[6] + 46820.*k3[6] - 
		49266.*k3[4]*q[2] + 187740.*k3[2]*q[4] - 22995.*q[6] - 
		6.*k[4]*(66043.*k3[2] - 333130.*q[2]) + 
		k[2]*(88699.*k3[4] - 918974.*k3[2]*q[2] + 847245*q[4])))/
		7. + 
		(4.*k[8]*q[1]*(585.*k[14]*k3[4] - 2475.*k3[10]*q[8] + 
		15.*k[2]*k3[8]*q[6]*(20.*k3[2] - 459.*q[2]) + 
		45.*k[4]*k3[6]*q[4]*(202.*k3[4] + 148.*k3[2]*q[2] + 
		135.*q[4]) - 
		15.*k[12]*(805.*k3[6] + 1822.*k3[4]*q[2] - 
		210.*k3[2]*q[4] + 189.*q[6]) + 
		k[10]*(5655.*k3[8] + 222610.*k3[6]*q[2] - 
		419226.*k3[4]*q[4] + 54180.*k3[2]*q[6] - 11340.*q[8]) + 
		2.*k[6]*k3[4]*(210.*k3[8] - 34455.*k3[6]*q[2] + 
		4766.*k3[4]*q[4] - 28605.*k3[2]*q[6] + 5175.*q[8]) + 
		k[8]*k3[2]*(5415.*k3[8] - 120370.*k3[6]*q[2] + 
		250234.*k3[4]*q[4] - 148950.*k3[2]*q[6] + 
		7560.*q[8])))/k3[4] -
		15.*k[7]*(k[1] - q[1])*(k[1] - q[1])*(k[1] + q[1])*(k[1] + q[1])*(39.*k[12] - 
		165.*k3[6]*q[6] - k[10]*(791.*k3[2] + 1947.*q[2]) + 
		k[8]*(601.*k3[4] + 1787.*k3[2]*q[2] + 1689.*q[4]) + 
		k[6]*(151.*k3[6] + 179.*k3[4]*q[2] - 
		1113.*k3[2]*q[4] + 219.*q[6]) + 
		k[4]*(269.*k3[6]*q[2] - 321.*k3[4]*q[4] + 
		405.*k3[2]*q[6]) - 51.*k[2]*(5.*k3[6]*q[4] + 
		9.*k3[4]*q[6]))*
		2.*my_log(my_abs((k[1] + q[1])/(k[1] - q[1]))) + (105.*k[14]*(2*k3[4] + 
		7.*k3[2]*q[2] - 9.*q[4])*
		(k[6]*(k3[4] + 2.*k3[2]*q[2] - 3.*q[4]) + 
		4.*k[4]*(4.*k3[6] - 14.*k3[4]*q[2] + 13.*k3[2]*q[4] - 
		3.*q[6]) - 
		2.*k3[4]*(k3[6] + k3[2]*q[4] - 2.*q[6]) + 
		k[2]*(-15.*k3[8] + 46.*k3[6]*q[2] - 47.*k3[4]*q[4] + 
		8.*k3[2]*q[6]))*2.*my_log(my_abs((k3[1] + q[1])/(k3[1] - q[1]))))/k3[5] - 
		(840.*k[17]*q[4]*(-2.*k3[4] - 7.*k3[2]*q[2] + 
		9.*q[4])*
		my_log((2.*k[2]*q[1] - k3[2]*q[1] + q[3] + 
		2.*k[1]*my_sqrt(q[2]*(k[2] - k3[2] + q[2])))/
		(2.*k[2]*q[1] - k3[2]*q[1] + q[3] - 
		2.*k[1]*my_sqrt(q[2]*(k[2] - k3[2] + q[2])))))/
		my_sqrt(q[2]*(k[2] - k3[2] + q[2]))
		+ (4320.*k[14]*k3[3]*q[4]*(k[2] - q[2])*(k[2] - q[2])*
		my_log(-((-(k[2]*q[1]) + 2.*k3[2]*q[1] + q[3] + 
		2.*k3[1]*my_sqrt(q[2]*(-k[2] + k3[2] + q[2])))/
		(k[2]*q[1] - 2.*k3[2]*q[1] - q[3] + 
		2.*k3[1]*my_sqrt(q[2]*(-k[2] + k3[2] + q[2]))))))/
		my_sqrt(q[2]*(-k[2] + k3[2] + q[2]))) 
		/eps[2]))/(6.20928e6*k[18]*q[5]);

}

histo_t kernel_Gamma2d_coll(histo_t k1_,histo_t k2_,histo_t k3_,histo_t q_)
{
	histo_t k1[NPOWERS],k2[NPOWERS],q[NPOWERS],eps[NPOWERS];
	powers(k1_,k1,NPOWERS); powers(k2_,k2,NPOWERS); powers(q_,q,NPOWERS); powers(k3_/k2_,eps,NPOWERS);

	return (M_PI*(-84.*k1[7]*k2[7]*q[3]*(43.*k1[6] + 43.*k2[6] - 
		3408.*k2[4]*q[2] - 2275.*k2[2]*q[4] + 180.*q[6] - 
		k1[4]*(403.*k2[2] + 3408.*q[2]) + 
		k1[2]*(-403.*k2[4] + 7736.*k2[2]*q[2] - 2275.*q[4])) + 
		12.*k1[1]*k2[1]*q[1]*(195.*k1[14]*k2[6] + 825.*k2[12]*q[8] - 
		5.*k1[2]*k2[10]*q[6]*(1949.*k2[2] + 855.*q[2]) + 
		5.*k1[4]*k2[8]*q[4]*(3895.*k2[4] + 8694.*k2[2]*q[2] + 
		471.*q[4]) + 
		k1[10]*k2[2]*(510.*k2[8] + 6590.*k2[6]*q[2] - 
		139742.*k2[4]*q[4] + 43470.*k2[2]*q[6] - 4275.*q[8]) - 
		5.*k1[12]*(90.*k2[8] + 1822.*k2[6]*q[2] - 
		3895.*k2[4]*q[4] + 1949.*k2[2]*q[6] - 165.*q[8]) + 
		k1[8]*k2[4]*(-450.*k2[8] + 6590.*k2[6]*q[2] + 
		246974.*k2[4]*q[4] - 49650.*k2[2]*q[6] + 2355.*q[8]) + 
		k1[6]*k2[6]*(195.*k2[8] - 9110.*k2[6]*q[2] - 
		139742.*k2[4]*q[4] - 49650.*k2[2]*q[6] + 3450.*q[8])) - 
		45.*k2[7]*(k1[1] - q[1])*(k1[1] - q[1])*(k1[1] + q[1])*(k1[1] + q[1])*(13.*k1[12] + 
		55.*k2[6]*q[6] - k1[10]*(194.*k2[2] + 649.*q[2]) + 
		k1[8]*(17.*k2[4] + 2297.*k2[2]*q[2] + 563.*q[4]) + 
		k1[6]*(164.*k2[6] - 2155.*k2[4]*q[2] - 
		2428.*k2[2]*q[4] + 73.*q[6]) + 
		k1[4]*(339.*k2[6]*q[2] + 2423.*k2[4]*q[4] + 
		157.*k2[2]*q[6]) - 3.*k1[2]*(186.*k2[6]*q[4] + 
		95.*k2[4]*q[6]))*2.*my_log(my_abs((k1[1] + q[1])/(k1[1] - q[1]))) - 
		45.*k1[7]*(k2[1] - q[1])*(k2[1] - q[1])*(k2[1] + q[1])*(k2[1] + q[1])*(k1[6]*(164.*k2[6] + 
		339.*k2[4]*q[2] - 558.*k2[2]*q[4] + 55.*q[6]) + 
		k2[6]*(13.*k2[6] - 649.*k2[4]*q[2] + 563.*k2[2]*q[4] + 
		73.*q[6]) + k1[4]*(17.*k2[8] - 2155.*k2[6]*q[2] + 
		2423.*k2[4]*q[4] - 285.*k2[2]*q[6]) + 
		k1[2]*(-194.*k2[10] + 2297.*k2[8]*q[2] - 
		2428.*k2[6]*q[4] + 157.*k2[4]*q[6]))*
		2.*my_log(my_abs((k2[1] + q[1])/(k2[1] - q[1]))) - 
		(7560.*k1[10]*k2[7]*q[4]*(k2[2] - q[2])*(k2[2] - q[2])*
		my_log((2.*k1[2]*q[1] - k2[2]*q[1] + q[3] + 
		2.*k1[1]*my_sqrt(q[2]*(k1[2] - k2[2] + q[2])))/
		(2.*k1[2]*q[1] - k2[2]*q[1] + q[3] - 
		2.*k1[1]*my_sqrt(q[2]*(k1[2] - k2[2] + q[2])))))/
		my_sqrt(q[2]*(k1[2] - k2[2] + q[2])) - 
		(7560.*k1[7]*k2[10]*q[4]*(k1[2] - q[2])*(k1[2] - q[2])*
		my_log(-((-(k1[2]*q[1]) + 2.*k2[2]*q[1] + q[3] + 
		2.*k2[1]*my_sqrt(q[2]*(-k1[2] + k2[2] + q[2])))/
		(k1[2]*q[1] - 2.*k2[2]*q[1] - q[3] + 
		2.*k2[1]*my_sqrt(q[2]*(-k1[2] + k2[2] + q[2]))))))/
		my_sqrt(q[2]*(-k1[2] + k2[2] + q[2]))))/
		(6.20928e6*k1[9]*k2[9]*q[5]) + 
		(eps[2]*M_PI*(8.*k1[7]*k2[9]*q[1]*
		(353.*k1[6] + 353.*k2[6] - 12896.*k2[4]*q[2] - 
		30541.*k2[2]*q[4] + 1785.*q[6] - k1[4]*(2033.*k2[2] + 
		12896.*q[2]) + k1[2]*(-2033.*k2[4] + 
		31896.*k2[2]*q[2] - 30541.*q[4])) - 
		4.*k1[1]*k2[3]*q[1]*(12075.*k1[12]*k2[6] + 
		7425.*k2[10]*q[8] - 90.*k1[2]*k2[8]*q[6]*(653.*k2[2] + 
		219.*q[2]) + 
		15.*k1[4]*k2[6]*q[4]*(7096.*k2[4] + 6566.*k2[2]*q[2] - 
		405.*q[4]) + 
		k1[6]*k2[4]*(12075.*k2[8] - 222610.*k2[6]*q[2] - 
		250234.*k2[4]*q[4] + 57210.*k2[2]*q[6] - 6075.*q[8]) - 
		5.*k1[10]*(4503.*k2[8] + 44522.*k2[6]*q[2] - 
		21288.*k2[4]*q[4] + 11754.*k2[2]*q[6] - 1485*q[8]) + 
		k1[8]*(-22515.*k2[10] + 455660.*k2[8]*q[2] - 
		250234.*k2[6]*q[4] + 98490.*k2[4]*q[6] - 
		19710.*k2[2]*q[8])) + 
		15.*k2[9]*(k1[1] - q[1])*(k1[1] - q[1])*(k1[1] + q[1])*(k1[1] + q[1])*(791.*k1[10] + 
		495.*k2[4]*q[6] - k1[8]*(2120.*k2[2] + 1787.*q[2]) + 
		k1[6]*(633.*k2[4] - 758.*k2[2]*q[2] + 1113.*q[4]) + 
		k1[4]*(1677.*k2[4]*q[2] + 4376.*k2[2]*q[4] - 
		405.*q[6]) - 
		3.*k1[2]*(1031.*k2[4]*q[4] + 438.*k2[2]*q[6]))*
		2.*my_log(my_abs((k1[1] + q[1])/(k1[1] - q[1]))) + 
		15.*k1[7]*k2[2]*(k2[1] - q[1])*(k2[1] - q[1])*(k2[1] + q[1])*(k2[1] + q[1])*
		(k2[4]*(791.*k2[6] - 1787.*k2[4]*q[2] + 
		1113.*k2[2]*q[4] - 405.*q[6]) + 
		3.*k1[4]*(211.*k2[6] + 559.*k2[4]*q[2] - 
		1031.*k2[2]*q[4] + 165.*q[6]) - 
		2.*k1[2]*(1060.*k2[8] + 379.*k2[6]*q[2] - 
		2188.*k2[4]*q[4] + 657.*k2[2]*q[6]))*
		2.*my_log(my_abs((k2[1] + q[1])/(k2[1] - q[1]))) + 
		(420.*k1[10]*k2[9]*q[3]*(k2[2] - q[2])*(k2[2] - q[2])*
		(-36.*k1[1]*my_sqrt(q[2]*(k1[2] - k2[2] + q[2])) + 
		q[1]*(14.*k1[2] - 5.*k2[2] + 5.*q[2])*
		my_log((2.*k1[2]*q[1] - k2[2]*q[1] + q[3] + 2.*k1[1]*
		my_sqrt(q[2]*(k1[2] - k2[2] + q[2])))/
		(2.*k1[2]*q[1] - k2[2]*q[1] + q[3] - 2.*k1[1]*
		my_sqrt(q[2]*(k1[2] - k2[2] + q[2]))))))/
		my_pow(q[2]*(k1[2] - k2[2] + q[2]),1.5) - 
		(420.*k1[7]*k2[12]*q[3]*(k1[2] - q[2])*(k1[2] - q[2])*
		(36.*k2[1]*my_sqrt(q[2]*(-k1[2] + k2[2] + q[2])) + 
		q[1]*(5.*k1[2] - 14.*k2[2] - 5.*q[2])*
		my_log(-((-(k1[2]*q[1]) + 2.*k2[2]*q[1] + q[3] + 
		2.*k2[1]*my_sqrt(q[2]*(-k1[2] + k2[2] + q[2])))/
		(k1[2]*q[1] - 2.*k2[2]*q[1] - q[3] + 
		2.*k2[1]*my_sqrt(q[2]*(-k1[2] + k2[2] + q[2])))))))/
		my_pow(q[2]*(-k1[2] + k2[2] + q[2]),1.5)))/
		(6.20928e6*k1[9]*k2[9]*q[5]) + 
		(eps[4]*M_PI*(17280.*k1[7]*k2[11]*q[1]*(k1[2] - q[2])*
		(k2[2] - q[2]) + 
		(4.*k1[7]*k2[11]*(304.*k1[6] + 304.*k2[6] - 
		4416.*k2[4]*q[2] + 21649.*k2[2]*q[4] + 224.*q[6] - 
		64.*k1[4]*(38.*k2[2] + 69.*q[2]) + 
		k1[2]*(-2432.*k2[4] + 15872.*k2[2]*q[2] + 
		21649.*q[4])))/q[1] + 
		4.*k1[1]*k2[5]*q[1]*(5655.*k1[10]*k2[6] + 7425.*k2[8]*q[8] + 
		45.*k1[4]*(865.*k2[8]*q[4] + 148.*k2[6]*q[6]) + 
		k1[6]*k2[2]*(5655.*k2[8] - 120370.*k2[6]*q[2] + 
		9532.*k2[4]*q[4] + 6660.*k2[2]*q[6] - 6885.*q[8]) + 
		5.*k1[8]*(2820.*k2[8] - 24074.*k2[6]*q[2] + 
		7785.*k2[4]*q[4] - 5967.*k2[2]*q[6] + 1485.*q[8]) - 
		2295.*k1[2]*(13.*k2[8]*q[6] + 3.*k2[6]*q[8])) - 
		15.*k2[11]*(k1[1] - q[1])*(k1[1] - q[1])*(k1[1] + q[1])*(k1[1] + q[1])*(601.*k1[8] + 
		495.*k2[2]*q[6] + k1[6]*(390.*k2[2] + 179.*q[2]) + 
		k1[4]*(391.*k2[2]*q[2] - 321.*q[4]) - 
		3.*k1[2]*(388.*k2[2]*q[4] + 153.*q[6]))*
		2.*my_log(my_abs((k1[1] + q[1])/(k1[1] - q[1]))) - 
		15.*k1[7]*k2[4]*(k2[1] - q[1])*(k2[1] - q[1])*(k2[1] + q[1])*(k2[1] + q[1])*
		(601.*k2[8] + 179.*k2[6]*q[2] - 321.*k2[4]*q[4] - 
		459.*k2[2]*q[6] + 
		k1[2]*(390.*k2[6] + 391.*k2[4]*q[2] - 
		1164.*k2[2]*q[4] + 495.*q[6]))*
		2.*my_log(my_abs((k2[1] + q[1])/(k2[1] - q[1]))) + 
		(105.*k1[10]*k2[11]*q[1]*my_pow(k2[2] - q[2],6)*
		my_sqrt(q[2]*(k1[2] - k2[2] + q[2]))*
		(-4.*k1[1]*my_sqrt(q[2]*(k1[2] - k2[2] + q[2]))*
		(-10.*k1[2] + 17.*(-k2[2] + q[2])) + 
		q[1]*(16.*k1[4] - 60.*k1[2]*(k2[2] - q[2]) + 
		17.*(k2[2] - q[2])*(k2[2] - q[2]))*
		my_log((2.*k1[2]*q[1] - k2[2]*q[1] + q[3] + 
		2.*k1[1]*my_sqrt(q[2]*(k1[2] - k2[2] + q[2])))/
		(2.*k1[2]*q[1] - k2[2]*q[1] + q[3] - 
		2.*k1[1]*my_sqrt(q[2]*(k1[2] - k2[2] + q[2]))))))/
		(my_pow(k1[2] - k2[2] + q[2],3)*my_pow(-(k2[2]*q[1]) + q[3],4)) + 
		(105.*k1[7]*k2[14]*q[1]*my_pow(k1[2] - q[2],6)*
		my_sqrt(q[2]*(-k1[2] + k2[2] + q[2]))*
		(-4.*k2[1]*my_sqrt(q[2]*(-k1[2] + k2[2] + q[2]))*
		(-17.*k1[2] - 10.*k2[2] + 17.*q[2]) + 
		q[1]*(17.*k1[4] + 16.*k2[4] + 60.*k2[2]*q[2] + 
		17.*q[4] - 2.*k1[2]*(30.*k2[2] + 17.*q[2]))*
		my_log(-((-(k1[2]*q[1]) + 2.*k2[2]*q[1] + q[3] + 
		2.*k2[1]*my_sqrt(q[2]*(-k1[2] + k2[2] + q[2])))/
		(k1[2]*q[1] - 2.*k2[2]*q[1] - q[3] + 
		2.*k2[1]*my_sqrt(q[2]*(-k1[2] + k2[2] + q[2])))))))/
		(my_pow(-k1[2] + k2[2] + q[2],3)*my_pow(-(k1[2]*q[1]) + q[3],4))))/
		(6.20928e6*k1[9]*k2[9]*q[5]);
}

histo_t kernel_Gamma2d_reg3rd(histo_t k1_,histo_t k2_,histo_t k3_,histo_t q_)
{
	histo_t k1[NPOWERS],k2[NPOWERS],k3[NPOWERS],q[NPOWERS];
	powers(k1_,k1,NPOWERS); powers(k2_,k2,NPOWERS); powers(k3_,k3,NPOWERS); powers(q_,q,NPOWERS);
	
	histo_t kernel_poly[13];
	histo_t kernel_beta[5];

	kernel_poly[0] = (-210*k1[11]*k2[9]*k3[8] - 210*k1[9]*k2[11]*k3[8] - 
		540*k1[9]*k2[9]*k3[10])*M_PI - 
		(1050*k1[11]*k2[9]*k3[7] + 1050*k1[9]*k2[11]*k3[7] + 
		840*k1[11]*k2[8]*k3[8] + 840*k1[10]*k2[9]*k3[8] + 
		840*k1[9]*k2[10]*k3[8] + 840*k1[8]*k2[11]*k3[8] + 
		2700*k1[9]*k2[9]*k3[9] + 
		2160*k1[9]*k2[8]*k3[10] + 2160*k1[8]*k2[9]*k3[10])*
		M_PI*q[1] - (-140*k1[13]*k2[7]*k3[6] + 
		3045*k1[11]*k2[9]*k3[6] + 
		3045*k1[9]*k2[11]*k3[6] - 
		140*k1[7]*k2[13]*k3[6] + 
		4200*k1[11]*k2[8]*k3[7] + 
		4200*k1[10]*k2[9]*k3[7] + 
		4200*k1[9]*k2[10]*k3[7] + 
		4200*k1[8]*k2[11]*k3[7] - 
		22050*k1[11]*k2[7]*k3[8] + 
		3360*k1[10]*k2[8]*k3[8] + 
		54120*k1[9]*k2[9]*k3[8] + 
		3360*k1[8]*k2[10]*k3[8] - 
		22050*k1[7]*k2[11]*k3[8] + 
		10800*k1[9]*k2[8]*k3[9] + 
		10800*k1[8]*k2[9]*k3[9] + 
		16560*k1[9]*k2[7]*k3[10] + 
		8640*k1[8]*k2[8]*k3[10] + 
		16560*k1[7]*k2[9]*k3[10] + 8880*k1[7]*k2[7]*k3[12]
		)*M_PI*q[2];

	kernel_poly[1] = - (-280*k1[13]*k2[7]*k3[5] + 
		3045*k1[11]*k2[9]*k3[5] + 
		3045*k1[9]*k2[11]*k3[5] - 
		280*k1[7]*k2[13]*k3[5] - 
		15320*k1[13]*k2[6]*k3[6] - 
		1730*k1[12]*k2[7]*k3[6] + 
		10650*k1[11]*k2[8]*k3[6] + 
		29640*k1[10]*k2[9]*k3[6] + 
		29640*k1[9]*k2[10]*k3[6] + 
		10650*k1[8]*k2[11]*k3[6] - 
		1730*k1[7]*k2[12]*k3[6] - 
		15320*k1[6]*k2[13]*k3[6] - 
		103530*k1[11]*k2[7]*k3[7] + 
		16800*k1[10]*k2[8]*k3[7] + 
		235560*k1[9]*k2[9]*k3[7] + 
		16800*k1[8]*k2[10]*k3[7] - 
		103530*k1[7]*k2[11]*k3[7] - 
		73410*k1[11]*k2[6]*k3[8] - 
		64470*k1[10]*k2[7]*k3[8] + 
		148680*k1[9]*k2[8]*k3[8] + 
		148680*k1[8]*k2[9]*k3[8] - 
		64470*k1[7]*k2[10]*k3[8] - 
		73410*k1[6]*k2[11]*k3[8] + 
		76500*k1[9]*k2[7]*k3[9] + 
		43200*k1[8]*k2[8]*k3[9] + 
		76500*k1[7]*k2[9]*k3[9] + 
		43740*k1[9]*k2[6]*k3[10] + 
		48210*k1[8]*k2[7]*k3[10] + 
		48210*k1[7]*k2[8]*k3[10] + 
		43740*k1[6]*k2[9]*k3[10] + 
		43560*k1[7]*k2[7]*k3[11] + 
		30990*k1[7]*k2[6]*k3[12] + 
		30990*k1[6]*k2[7]*k3[12])*M_PI*q[3] - 
		(-1750*k1[13]*k2[7]*k3[4] + 
		9520*k1[11]*k2[9]*k3[4] + 
		9520*k1[9]*k2[11]*k3[4] - 
		1750*k1[7]*k2[13]*k3[4] - 
		74920*k1[13]*k2[6]*k3[5] - 
		6970*k1[12]*k2[7]*k3[5] + 
		4530*k1[11]*k2[8]*k3[5] + 
		99480*k1[10]*k2[9]*k3[5] + 
		99480*k1[9]*k2[10]*k3[5] + 
		4530*k1[8]*k2[11]*k3[5] - 
		6970*k1[7]*k2[12]*k3[5] - 
		74920*k1[6]*k2[13]*k3[5] - 
		2160*k1[13]*k2[5]*k3[6] - 
		65960*k1[12]*k2[6]*k3[6] - 
		111003*k1[11]*k2[7]*k3[6] + 
		112440*k1[10]*k2[8]*k3[6] + 
		292656*k1[9]*k2[9]*k3[6] + 
		112440*k1[8]*k2[10]*k3[6] - 
		111003*k1[7]*k2[11]*k3[6] - 
		65960*k1[6]*k2[12]*k3[6] - 
		2160*k1[5]*k2[13]*k3[6] - 
		340170*k1[11]*k2[6]*k3[7] - 
		295470*k1[10]*k2[7]*k3[7] + 
		603240*k1[9]*k2[8]*k3[7] + 
		603240*k1[8]*k2[9]*k3[7] - 
		295470*k1[7]*k2[10]*k3[7] - 
		340170*k1[6]*k2[11]*k3[7] - 
		131130*k1[11]*k2[5]*k3[8] - 
		198720*k1[10]*k2[6]*k3[8] + 
		288522*k1[9]*k2[7]*k3[8] + 
		323520*k1[8]*k2[8]*k3[8] + 
		288522*k1[7]*k2[9]*k3[8] - 
		198720*k1[6]*k2[10]*k3[8] - 
		131130*k1[5]*k2[11]*k3[8] + 
		193500*k1[9]*k2[6]*k3[9] + 
		215850*k1[8]*k2[7]*k3[9] + 
		215850*k1[7]*k2[8]*k3[9] + 
		193500*k1[6]*k2[9]*k3[9] + 
		81940*k1[9]*k2[5]*k3[10] + 
		102840*k1[8]*k2[6]*k3[10] + 
		294336*k1[7]*k2[7]*k3[10] + 
		102840*k1[6]*k2[8]*k3[10] + 
		81940*k1[5]*k2[9]*k3[10] + 
		151590*k1[7]*k2[6]*k3[11] + 
		151590*k1[6]*k2[7]*k3[11] + 
		54600*k1[7]*k2[5]*k3[12] + 
		105840*k1[6]*k2[6]*k3[12] + 
		54600*k1[5]*k2[7]*k3[12])*M_PI*q[4];

	kernel_poly[2] = - (-980*k1[13]*k2[7]*k3[3] - 
		8050*k1[11]*k2[9]*k3[3] - 
		8050*k1[9]*k2[11]*k3[3] - 
		980*k1[7]*k2[13]*k3[3] - 
		154600*k1[13]*k2[6]*k3[4] - 
		18700*k1[12]*k2[7]*k3[4] + 
		22780*k1[11]*k2[8]*k3[4] + 
		212680*k1[10]*k2[9]*k3[4] + 
		212680*k1[9]*k2[10]*k3[4] + 
		22780*k1[8]*k2[11]*k3[4] - 
		18700*k1[7]*k2[12]*k3[4] - 
		154600*k1[6]*k2[13]*k3[4] - 
		8280*k1[13]*k2[5]*k3[5] - 
		323080*k1[12]*k2[6]*k3[5] + 
		304585*k1[11]*k2[7]*k3[5] + 
		367320*k1[10]*k2[8]*k3[5] - 
		529280*k1[9]*k2[9]*k3[5] + 
		367320*k1[8]*k2[10]*k3[5] + 
		304585*k1[7]*k2[11]*k3[5] - 
		323080*k1[6]*k2[12]*k3[5] - 
		8280*k1[5]*k2[13]*k3[5] - 
		75710*k1[13]*k2[4]*k3[6] -
		15660*k1[12]*k2[5]*k3[6] - 
		213702*k1[11]*k2[6]*k3[6] - 
		43862*k1[10]*k2[7]*k3[6] + 
		304374*k1[9]*k2[8]*k3[6] + 
		304374*k1[8]*k2[9]*k3[6] - 
		43862*k1[7]*k2[10]*k3[6] - 
		213702*k1[6]*k2[11]*k3[6] - 
		15660*k1[5]*k2[12]*k3[6] - 
		75710*k1[4]*k2[13]*k3[6] - 
		615330*k1[11]*k2[5]*k3[7] - 
		886080*k1[10]*k2[6]*k3[7] + 
		739260*k1[9]*k2[7]*k3[7] + 
		1056960*k1[8]*k2[8]*k3[7] + 
		739260*k1[7]*k2[9]*k3[7] - 
		886080*k1[6]*k2[10]*k3[7] - 
		615330*k1[5]*k2[11]*k3[7] + 
		41790*k1[11]*k2[4]*k3[8] - 
		382140*k1[10]*k2[5]*k3[8] - 
		99352*k1[9]*k2[6]*k3[8] + 
		1042858*k1[8]*k2[7]*k3[8] + 
		1042858*k1[7]*k2[8]*k3[8] - 
		99352*k1[6]*k2[9]*k3[8] - 
		382140*k1[5]*k2[10]*k3[8] + 
		41790*k1[4]*k2[11]*k3[8] + 
		371900*k1[9]*k2[5]*k3[9] + 
		413400*k1[8]*k2[6]*k3[9] + 
		1038220*k1[7]*k2[7]*k3[9] + 
		413400*k1[6]*k2[8]*k3[9] + 
		371900*k1[5]*k2[9]*k3[9] + 
		16270*k1[9]*k2[4]*k3[10] + 
		219580*k1[8]*k2[5]*k3[10] + 
		677194*k1[7]*k2[6]*k3[10] + 
		677194*k1[6]*k2[7]*k3[10] + 
		219580*k1[5]*k2[8]*k3[10] + 
		16270*k1[4]*k2[9]*k3[10] + 
		267960*k1[7]*k2[5]*k3[11] + 
		515760*k1[6]*k2[6]*k3[11] + 
		267960*k1[5]*k2[7]*k3[11] + 
		20650*k1[7]*k2[4]*k3[12] + 
		191220*k1[6]*k2[5]*k3[12] + 
		191220*k1[5]*k2[6]*k3[12] + 
		20650*k1[4]*k2[7]*k3[12])*M_PI*q[5] - 
		(-3780*k1[13]*k2[7]*k3[2] - 945*k1[11]*k2[9]*k3[2] - 
		945*k1[9]*k2[11]*k3[2] - 
		3780*k1[7]*k2[13]*k3[2] - 
		151520*k1[13]*k2[6]*k3[3] - 
		15620*k1[12]*k2[7]*k3[3] - 
		47500*k1[11]*k2[8]*k3[3] + 
		142400*k1[10]*k2[9]*k3[3] + 
		142400*k1[9]*k2[10]*k3[3] - 
		47500*k1[8]*k2[11]*k3[3] - 
		15620*k1[7]*k2[12]*k3[3] - 
		151520*k1[6]*k2[13]*k3[3] - 
		23700*k1[13]*k2[5]*k3[4] - 
		665200*k1[12]*k2[6]*k3[4] + 
		946640*k1[11]*k2[7]*k3[4] + 
		789520*k1[10]*k2[8]*k3[4] - 
		1678160*k1[9]*k2[9]*k3[4] + 
		789520*k1[8]*k2[10]*k3[4] + 
		946640*k1[7]*k2[11]*k3[4] - 
		665200*k1[6]*k2[12]*k3[4] - 
		23700*k1[5]*k2[13]*k3[4] - 
		376870*k1[13]*k2[4]*k3[5] - 
		68220*k1[12]*k2[5]*k3[5] + 
		1853890*k1[11]*k2[6]*k3[5] + 
		2261490*k1[10]*k2[7]*k3[5] - 
		3660770*k1[9]*k2[8]*k3[5] - 
		3660770*k1[8]*k2[9]*k3[5] + 
		2261490*k1[7]*k2[10]*k3[5] + 
		1853890*k1[6]*k2[11]*k3[5] - 
		68220*k1[5]*k2[12]*k3[5] - 
		376870*k1[4]*k2[13]*k3[5] - 
		44780*k1[13]*k2[3]*k3[6] - 
		307520*k1[12]*k2[4]*k3[6] - 
		904953*k1[11]*k2[5]*k3[6] + 
		691792*k1[10]*k2[6]*k3[6] + 
		983773*k1[9]*k2[7]*k3[6] - 
		2186304*k1[8]*k2[8]*k3[6] + 
		983773*k1[7]*k2[9]*k3[6] + 
		691792*k1[6]*k2[10]*k3[6] - 
		904953*k1[5]*k2[11]*k3[6] - 
		307520*k1[4]*k2[12]*k3[6] - 
		44780*k1[3]*k2[13]*k3[6] + 
		235830*k1[11]*k2[4]*k3[7] - 
		1749420*k1[10]*k2[5]*k3[7] - 
		2141360*k1[9]*k2[6]*k3[7] + 
		2987690*k1[8]*k2[7]*k3[7] + 
		2987690*k1[7]*k2[8]*k3[7] - 
		2141360*k1[6]*k2[9]*k3[7] - 
		1749420*k1[5]*k2[10]*k3[7] + 
		235830*k1[4]*k2[11]*k3[7] + 
		59730*k1[11]*k2[3]*k3[8] + 
		262080*k1[10]*k2[4]*k3[8] - 
		314308*k1[9]*k2[5]*k3[8] + 
		133872*k1[8]*k2[6]*k3[8] + 
		3788204*k1[7]*k2[7]*k3[8] + 
		133872*k1[6]*k2[8]*k3[8] - 
		314308*k1[5]*k2[9]*k3[8] + 
		262080*k1[4]*k2[10]*k3[8] + 
		59730*k1[3]*k2[11]*k3[8] + 
		56150*k1[9]*k2[4]*k3[9] + 
		946700*k1[8]*k2[5]*k3[9] + 
		1959330*k1[7]*k2[6]*k3[9] + 
		1959330*k1[6]*k2[7]*k3[9] + 
		946700*k1[5]*k2[8]*k3[9] + 
		56150*k1[4]*k2[9]*k3[9] - 
		16280*k1[9]*k2[3]*k3[10] - 
		7040*k1[8]*k2[4]*k3[10] + 
		1125136*k1[7]*k2[5]*k3[10] + 
		1392176*k1[6]*k2[6]*k3[10] + 
		1125136*k1[5]*k2[7]*k3[10] - 
		7040*k1[4]*k2[8]*k3[10] - 
		16280*k1[3]*k2[9]*k3[10] + 
		99890*k1[7]*k2[4]*k3[11] + 
		935940*k1[6]*k2[5]*k3[11] + 
		935940*k1[5]*k2[6]*k3[11] + 
		99890*k1[4]*k2[7]*k3[11] + 
		2080*k1[7]*k2[3]*k3[12] + 
		64480*k1[6]*k2[4]*k3[12] + 
		335520*k1[5]*k2[5]*k3[12] + 
		64480*k1[4]*k2[6]*k3[12] + 2080*k1[3]*k2[7]*k3[12]
		)*M_PI*q[6];

	kernel_poly[3] = - (1260*k1[13]*k2[7]*k3[1] - 
		2205*k1[11]*k2[9]*k3[1] - 2205*k1[9]*k2[11]*k3[1] + 
		1260*k1[7]*k2[13]*k3[1] - 88920*k1[13]*k2[6]*k3[2] - 
		20970*k1[12]*k2[7]*k3[2] - 
		11430*k1[11]*k2[8]*k3[2] + 
		83520*k1[10]*k2[9]*k3[2] + 
		83520*k1[9]*k2[10]*k3[2] - 
		11430*k1[8]*k2[11]*k3[2] - 
		20970*k1[7]*k2[12]*k3[2] - 
		88920*k1[6]*k2[13]*k3[2] - 
		19080*k1[13]*k2[5]*k3[3] - 
		652880*k1[12]*k2[6]*k3[3] + 
		788440*k1[11]*k2[7]*k3[3] + 
		508400*k1[10]*k2[8]*k3[3] - 
		1728280*k1[9]*k2[9]*k3[3] + 
		508400*k1[8]*k2[10]*k3[3] + 
		788440*k1[7]*k2[11]*k3[3] - 
		652880*k1[6]*k2[12]*k3[3] - 
		19080*k1[5]*k2[13]*k3[3] - 
		758500*k1[13]*k2[4]*k3[4] - 
		165000*k1[12]*k2[5]*k3[4] + 
		4704210*k1[11]*k2[6]*k3[4] + 
		5540710*k1[10]*k2[7]*k3[4] - 
		8914540*k1[9]*k2[8]*k3[4] - 
		8914540*k1[8]*k2[9]*k3[4] + 
		5540710*k1[7]*k2[10]*k3[4] + 
		4704210*k1[6]*k2[11]*k3[4] - 
		165000*k1[5]*k2[12]*k3[4] - 
		758500*k1[4]*k2[13]*k3[4] - 
		223480*k1[13]*k2[3]*k3[5] - 
		1530880*k1[12]*k2[4]*k3[5] + 
		718335*k1[11]*k2[5]*k3[5] + 
		11318160*k1[10]*k2[6]*k3[5] - 
		440535*k1[9]*k2[7]*k3[5] - 
		20511680*k1[8]*k2[8]*k3[5] - 
		440535*k1[7]*k2[9]*k3[5] +
		11318160*k1[6]*k2[10]*k3[5] + 
		718335*k1[5]*k2[11]*k3[5] - 
		1530880*k1[4]*k2[12]*k3[5] - 
		223480*k1[3]*k2[13]*k3[5] + 
		52860*k1[13]*k2[2]*k3[6] - 
		180290*k1[12]*k2[3]*k3[6] - 
		132642*k1[11]*k2[4]*k3[6] - 
		1803612*k1[10]*k2[5]*k3[6] - 
		1894968*k1[9]*k2[6]*k3[6] + 
		1490722*k1[8]*k2[7]*k3[6] + 
		1490722*k1[7]*k2[8]*k3[6] - 
		1894968*k1[6]*k2[9]*k3[6] - 
		1803612*k1[5]*k2[10]*k3[6] - 
		132642*k1[4]*k2[11]*k3[6] - 
		180290*k1[3]*k2[12]*k3[6] + 
		52860*k1[2]*k2[13]*k3[6] + 
		305370*k1[11]*k2[3]*k3[7] + 
		1417920*k1[10]*k2[4]*k3[7] - 
		4624440*k1[9]*k2[5]*k3[7] - 
		3561840*k1[8]*k2[6]*k3[7] + 
		10024860*k1[7]*k2[7]*k3[7] - 
		3561840*k1[6]*k2[8]*k3[7] - 
		4624440*k1[5]*k2[9]*k3[7] + 
		1417920*k1[4]*k2[10]*k3[7] + 
		305370*k1[3]*k2[11]*k3[7] - 
		100710*k1[11]*k2[2]*k3[8] + 
		262650*k1[10]*k2[3]*k3[8] + 
		372928*k1[9]*k2[4]*k3[8] + 
		277988*k1[8]*k2[5]*k3[8] + 
		3941126*k1[7]*k2[6]*k3[8] + 
		3941126*k1[6]*k2[7]*k3[8] + 
		277988*k1[5]*k2[8]*k3[8] + 
		372928*k1[4]*k2[9]*k3[8] + 
		262650*k1[3]*k2[10]*k3[8] - 
		100710*k1[2]*k2[11]*k3[8] - 
		87700*k1[9]*k2[3]*k3[9] - 
		136000*k1[8]*k2[4]*k3[9] + 
		3192620*k1[7]*k2[5]*k3[9] + 
		2483120*k1[6]*k2[6]*k3[9] + 
		3192620*k1[5]*k2[7]*k3[9] - 
		136000*k1[4]*k2[8]*k3[9] - 
		87700*k1[3]*k2[9]*k3[9] + 
		42840*k1[9]*k2[2]*k3[10] - 
		83150*k1[8]*k2[3]*k3[10] + 
		359494*k1[7]*k2[4]*k3[10] + 
		2257544*k1[6]*k2[5]*k3[10] + 
		2257544*k1[5]*k2[6]*k3[10] + 
		359494*k1[4]*k2[7]*k3[10] - 
		83150*k1[3]*k2[8]*k3[10] + 
		42840*k1[2]*k2[9]*k3[10] + 
		9560*k1[7]*k2[3]*k3[11] + 
		308960*k1[6]*k2[4]*k3[11] + 
		1647360*k1[5]*k2[5]*k3[11] + 
		308960*k1[4]*k2[6]*k3[11] + 
		9560*k1[3]*k2[7]*k3[11] + 
		5010*k1[7]*k2[2]*k3[12] + 
		3790*k1[6]*k2[3]*k3[12] + 
		129180*k1[5]*k2[4]*k3[12] + 
		129180*k1[4]*k2[5]*k3[12] + 
		3790*k1[3]*k2[6]*k3[12] + 5010*k1[2]*k2[7]*k3[12])*
		M_PI*q[7];
	
	kernel_poly[4] = - (5670*k1[13]*k2[7] - 5670*k1[11]*k2[9] - 
		5670*k1[9]*k2[11] + 5670*k1[7]*k2[13] - 
		9720*k1[13]*k2[6]*k3[1] + 3870*k1[12]*k2[7]*k3[1] - 
		10350*k1[11]*k2[8]*k3[1] + 8640*k1[10]*k2[9]*k3[1] + 
		8640*k1[9]*k2[10]*k3[1] - 10350*k1[8]*k2[11]*k3[1] + 
		3870*k1[7]*k2[12]*k3[1] - 9720*k1[6]*k2[13]*k3[1] - 
		29280*k1[13]*k2[5]*k3[2] - 
		379080*k1[12]*k2[6]*k3[2] + 
		314805*k1[11]*k2[7]*k3[2] + 
		303480*k1[10]*k2[8]*k3[2] - 
		683820*k1[9]*k2[9]*k3[2] + 
		303480*k1[8]*k2[10]*k3[2] + 
		314805*k1[7]*k2[11]*k3[2] - 
		379080*k1[6]*k2[12]*k3[2] - 
		29280*k1[5]*k2[13]*k3[2] - 
		755420*k1[13]*k2[4]*k3[3] - 
		146520*k1[12]*k2[5]*k3[3] + 
		4346850*k1[11]*k2[6]*k3[3] + 
		4797590*k1[10]*k2[7]*k3[3] - 
		8509220*k1[9]*k2[8]*k3[3] - 
		8509220*k1[8]*k2[9]*k3[3] + 
		4797590*k1[7]*k2[10]*k3[3] + 
		4346850*k1[6]*k2[11]*k3[3] - 
		146520*k1[5]*k2[12]*k3[3] - 
		755420*k1[4]*k2[13]*k3[3] - 
		448150*k1[13]*k2[3]*k3[4] - 
		3080800*k1[12]*k2[4]*k3[4] + 
		3213640*k1[11]*k2[5]*k3[4] + 
		25293440*k1[10]*k2[6]*k3[4] - 
		2619000*k1[9]*k2[7]*k3[4] - 
		43853760*k1[8]*k2[8]*k3[4] - 
		2619000*k1[7]*k2[9]*k3[4] + 
		25293440*k1[6]*k2[10]*k3[4] + 
		3213640*k1[5]*k2[11]*k3[4] - 
		3080800*k1[4]*k2[12]*k3[4] - 
		448150*k1[3]*k2[13]*k3[4] + 
		264300*k1[13]*k2[2]*k3[5] - 
		899770*k1[12]*k2[3]*k3[5] - 
		2333690*k1[11]*k2[4]*k3[5] + 
		6208740*k1[10]*k2[5]*k3[5] + 
		10942680*k1[9]*k2[6]*k3[5] - 
		15817350*k1[8]*k2[7]*k3[5] - 
		15817350*k1[7]*k2[8]*k3[5] + 
		10942680*k1[6]*k2[9]*k3[5] + 
		6208740*k1[5]*k2[10]*k3[5] - 
		2333690*k1[4]*k2[11]*k3[5] - 
		899770*k1[3]*k2[12]*k3[5] + 
		264300*k1[2]*k2[13]*k3[5] + 
		3960*k1[13]*k2[1]*k3[6] + 
		211440*k1[12]*k2[2]*k3[6] + 
		341967*k1[11]*k2[3]*k3[6] + 
		2153992*k1[10]*k2[4]*k3[6] - 
		8735142*k1[9]*k2[5]*k3[6] - 
		7746192*k1[8]*k2[6]*k3[6] + 
		14450810*k1[7]*k2[7]*k3[6] - 
		7746192*k1[6]*k2[8]*k3[6] - 
		8735142*k1[5]*k2[9]*k3[6] + 
		2153992*k1[4]*k2[10]*k3[6] + 
		341967*k1[3]*k2[11]*k3[6] + 
		211440*k1[2]*k2[12]*k3[6] + 
		3960*k1[1]*k2[13]*k3[6] - 
		503550*k1[11]*k2[2]*k3[7] + 
		1340130*k1[10]*k2[3]*k3[7] + 
		1372600*k1[9]*k2[4]*k3[7] - 
		7300860*k1[8]*k2[5]*k3[7] + 
		3942230*k1[7]*k2[6]*k3[7] + 
		3942230*k1[6]*k2[7]*k3[7] - 
		7300860*k1[5]*k2[8]*k3[7] + 
		1372600*k1[4]*k2[9]*k3[7] + 
		1340130*k1[3]*k2[10]*k3[7] - 
		503550*k1[2]*k2[11]*k3[7] - 
		11880*k1[11]*k2[1]*k3[8] - 
		402840*k1[10]*k2[2]*k3[8] + 
		178912*k1[9]*k2[3]*k3[8] - 
		26608*k1[8]*k2[4]*k3[8] + 
		4885714*k1[7]*k2[5]*k3[8] + 
		3813024*k1[6]*k2[6]*k3[8] + 
		4885714*k1[5]*k2[7]*k3[8] - 
		26608*k1[4]*k2[8]*k3[8] + 
		178912*k1[3]*k2[9]*k3[8] - 
		402840*k1[2]*k2[10]*k3[8] - 
		11880*k1[1]*k2[11]*k3[8] + 
		214200*k1[9]*k2[2]*k3[9] - 
		440950*k1[8]*k2[3]*k3[9] + 
		809630*k1[7]*k2[4]*k3[9] + 
		3398680*k1[6]*k2[5]*k3[9] + 
		3398680*k1[5]*k2[6]*k3[9] + 
		809630*k1[4]*k2[7]*k3[9] - 
		440950*k1[3]*k2[8]*k3[9] + 
		214200*k1[2]*k2[9]*k3[9] + 
		11880*k1[9]*k2[1]*k3[10] + 
		171360*k1[8]*k2[2]*k3[10] - 
		74624*k1[7]*k2[3]*k3[10] + 
		717576*k1[6]*k2[4]*k3[10] + 
		3463436*k1[5]*k2[5]*k3[10] + 
		717576*k1[4]*k2[6]*k3[10] - 
		74624*k1[3]*k2[7]*k3[10] + 
		171360*k1[2]*k2[8]*k3[10] + 
		11880*k1[1]*k2[9]*k3[10] + 
		25050*k1[7]*k2[2]*k3[11] + 
		15590*k1[6]*k2[3]*k3[11] + 
		625740*k1[5]*k2[4]*k3[11] + 
		625740*k1[4]*k2[5]*k3[11] + 
		15590*k1[3]*k2[6]*k3[11] + 
		25050*k1[2]*k2[7]*k3[11] - 3960*k1[7]*k2[1]*k3[12] + 
		20040*k1[6]*k2[2]*k3[12] + 
		13800*k1[5]*k2[3]*k3[12] + 
		23120*k1[4]*k2[4]*k3[12] + 
		13800*k1[3]*k2[5]*k3[12] + 
		20040*k1[2]*k2[6]*k3[12] - 3960*k1[1]*k2[7]*k3[12])*
		M_PI*q[8];

	kernel_poly[5] = - (22680*k1[13]*k2[6] + 
		22680*k1[12]*k2[7] - 22680*k1[11]*k2[8] - 
		22680*k1[10]*k2[9] - 22680*k1[9]*k2[10] - 
		22680*k1[8]*k2[11] + 22680*k1[7]*k2[12] + 
		22680*k1[6]*k2[13] + 6240*k1[13]*k2[5]*k3[1] - 
		43560*k1[12]*k2[6]*k3[1] + 87657*k1[11]*k2[7]*k3[1] + 
		28440*k1[10]*k2[8]*k3[1] - 207324*k1[9]*k2[9]*k3[1] + 
		28440*k1[8]*k2[10]*k3[1] + 87657*k1[7]*k2[11]*k3[1] - 
		43560*k1[6]*k2[12]*k3[1] + 6240*k1[5]*k2[13]*k3[1] - 
		390870*k1[13]*k2[4]*k3[2] - 
		152220*k1[12]*k2[5]*k3[2] + 
		1784670*k1[11]*k2[6]*k3[2] + 
		2135070*k1[10]*k2[7]*k3[2] - 
		3563130*k1[9]*k2[8]*k3[2] - 
		3563130*k1[8]*k2[9]*k3[2] + 
		2135070*k1[7]*k2[10]*k3[2] + 
		1784670*k1[6]*k2[11]*k3[2] - 
		152220*k1[5]*k2[12]*k3[2] - 
		390870*k1[4]*k2[13]*k3[2] - 
		447380*k1[13]*k2[3]*k3[3] - 
		3068480*k1[12]*k2[4]*k3[3] + 
		2845310*k1[11]*k2[5]*k3[3] + 
		23422720*k1[10]*k2[6]*k3[3] - 
		2707278*k1[9]*k2[7]*k3[3] - 
		39809280*k1[8]*k2[8]*k3[3] - 
		2707278*k1[7]*k2[9]*k3[3] + 
		23422720*k1[6]*k2[10]*k3[3] + 
		2845310*k1[5]*k2[11]*k3[3] - 
		3068480*k1[4]*k2[12]*k3[3] - 
		447380*k1[3]*k2[13]*k3[3] + 
		528600*k1[13]*k2[2]*k3[4] - 
		1804300*k1[12]*k2[3]*k3[4] - 
		5425270*k1[11]*k2[4]*k3[4] + 
		17532460*k1[10]*k2[5]*k3[4] + 
		28922920*k1[9]*k2[6]*k3[4] - 
		39858850*k1[8]*k2[7]*k3[4] - 
		39858850*k1[7]*k2[8]*k3[4] + 
		28922920*k1[6]*k2[9]*k3[4] + 
		17532460*k1[5]*k2[10]*k3[4] - 
		5425270*k1[4]*k2[11]*k3[4] - 
		1804300*k1[3]*k2[12]*k3[4] + 
		528600*k1[2]*k2[13]*k3[4] + 
		19800*k1[13]*k2[1]*k3[5] + 
		1057200*k1[12]*k2[2]*k3[5] - 
		679085*k1[11]*k2[3]*k3[5] + 
		257640*k1[10]*k2[4]*k3[5] - 
		257550*k1[9]*k2[5]*k3[5] - 
		4954320*k1[8]*k2[6]*k3[5] + 
		539566*k1[7]*k2[7]*k3[5] - 
		4954320*k1[6]*k2[8]*k3[5] - 
		257550*k1[5]*k2[9]*k3[5] + 
		257640*k1[4]*k2[10]*k3[5] - 
		679085*k1[3]*k2[11]*k3[5] + 
		1057200*k1[2]*k2[12]*k3[5] + 
		19800*k1[1]*k2[13]*k3[5] - 4950*k1[13]*k3[6] + 
		15840*k1[12]*k2[1]*k3[6] - 
		664290*k1[11]*k2[2]*k3[6] + 
		2556058*k1[10]*k2[3]*k3[6] + 
		1376058*k1[9]*k2[4]*k3[6] - 
		17106078*k1[8]*k2[5]*k3[6] + 
		3816522*k1[7]*k2[6]*k3[6] + 
		3816522*k1[6]*k2[7]*k3[6] - 
		17106078*k1[5]*k2[8]*k3[6] + 
		1376058*k1[4]*k2[9]*k3[6] + 
		2556058*k1[3]*k2[10]*k3[6] - 
		664290*k1[2]*k2[11]*k3[6] + 
		15840*k1[1]*k2[12]*k3[6] - 4950*k2[13]*k3[6] - 
		59400*k1[11]*k2[1]*k3[7] - 
		2014200*k1[10]*k2[2]*k3[7] + 
		1585450*k1[9]*k2[3]*k3[7] + 
		246000*k1[8]*k2[4]*k3[7] - 
		132740*k1[7]*k2[5]*k3[7] + 
		2880480*k1[6]*k2[6]*k3[7] - 
		132740*k1[5]*k2[7]*k3[7] + 
		246000*k1[4]*k2[8]*k3[7] + 
		1585450*k1[3]*k2[9]*k3[7] - 
		2014200*k1[2]*k2[10]*k3[7] - 
		59400*k1[1]*k2[11]*k3[7] + 14850*k1[11]*k3[8] - 
		47520*k1[10]*k2[1]*k3[8] - 
		215280*k1[9]*k2[2]*k3[8] - 
		649582*k1[8]*k2[3]*k3[8] + 
		2094318*k1[7]*k2[4]*k3[8] + 
		4030196*k1[6]*k2[5]*k3[8] + 
		4030196*k1[5]*k2[6]*k3[8] + 
		2094318*k1[4]*k2[7]*k3[8] - 
		649582*k1[3]*k2[8]*k3[8] - 
		215280*k1[2]*k2[9]*k3[8] - 
		47520*k1[1]*k2[10]*k3[8] + 14850*k2[11]*k3[8] + 
		59400*k1[9]*k2[1]*k3[9] + 856800*k1[8]*k2[2]*k3[9] - 
		496780*k1[7]*k2[3]*k3[9] + 
		865320*k1[6]*k2[4]*k3[9] + 
		3725020*k1[5]*k2[5]*k3[9] + 
		865320*k1[4]*k2[6]*k3[9] - 
		496780*k1[3]*k2[7]*k3[9] + 
		856800*k1[2]*k2[8]*k3[9] + 59400*k1[1]*k2[9]*k3[9] - 
		14850*k1[9]*k3[10] + 47520*k1[8]*k2[1]*k3[10] + 
		320910*k1[7]*k2[2]*k3[10] - 
		71646*k1[6]*k2[3]*k3[10] + 
		1306874*k1[5]*k2[4]*k3[10] + 
		1306874*k1[4]*k2[5]*k3[10] - 
		71646*k1[3]*k2[6]*k3[10] + 
		320910*k1[2]*k2[7]*k3[10] + 
		47520*k1[1]*k2[8]*k3[10] - 14850*k2[9]*k3[10] - 
		19800*k1[7]*k2[1]*k3[11] + 
		100200*k1[6]*k2[2]*k3[11] + 
		63960*k1[5]*k2[3]*k3[11] + 
		102160*k1[4]*k2[4]*k3[11] + 
		63960*k1[3]*k2[5]*k3[11] + 
		100200*k1[2]*k2[6]*k3[11] - 
		19800*k1[1]*k2[7]*k3[11] + 4950*k1[7]*k3[12] - 
		15840*k1[6]*k2[1]*k3[12] + 
		30060*k1[5]*k2[2]*k3[12] - 
		6550*k1[4]*k2[3]*k3[12] - 
		6550*k1[3]*k2[4]*k3[12] + 
		30060*k1[2]*k2[5]*k3[12] - 
		15840*k1[1]*k2[6]*k3[12] + 4950*k2[7]*k3[12])*M_PI*q[9];

	kernel_poly[6] = - (34020*k1[13]*k2[5] + 90720*k1[12]*k2[6] + 
		22680*k1[11]*k2[7] - 90720*k1[10]*k2[8] - 
		113400*k1[9]*k2[9] - 90720*k1[8]*k2[10] + 
		22680*k1[7]*k2[11] + 90720*k1[6]*k2[12] + 
		34020*k1[5]*k2[13] - 70110*k1[13]*k2[4]*k3[1] + 
		17940*k1[12]*k2[5]*k3[1] + 496038*k1[11]*k2[6]*k3[1] + 
		485478*k1[10]*k2[7]*k3[1] - 954546*k1[9]*k2[8]*k3[1] - 
		954546*k1[8]*k2[9]*k3[1] + 485478*k1[7]*k2[10]*k3[1] + 
		496038*k1[6]*k2[11]*k3[1] + 17940*k1[5]*k2[12]*k3[1] - 
		70110*k1[4]*k2[13]*k3[1] - 
		226980*k1[13]*k2[3]*k3[2] - 
		1586880*k1[12]*k2[4]*k3[2] + 
		834105*k1[11]*k2[5]*k3[2] + 
		10372080*k1[10]*k2[6]*k3[2] - 
		861015*k1[9]*k2[7]*k3[2] - 
		17257920*k1[8]*k2[8]*k3[2] - 
		861015*k1[7]*k2[9]*k3[2] + 
		10372080*k1[6]*k2[10]*k3[2] + 
		834105*k1[5]*k2[11]*k3[2] - 
		1586880*k1[4]*k2[12]*k3[2] - 
		226980*k1[3]*k2[13]*k3[2] + 
		528600*k1[13]*k2[2]*k3[3] - 
		1801220*k1[12]*k2[3]*k3[3] - 
		6176510*k1[11]*k2[4]*k3[3] + 
		15397220*k1[10]*k2[5]*k3[3] + 
		27847688*k1[9]*k2[6]*k3[3] - 
		35470922*k1[8]*k2[7]*k3[3] - 
		35470922*k1[7]*k2[8]*k3[3] + 
		27847688*k1[6]*k2[9]*k3[3] + 
		15397220*k1[5]*k2[10]*k3[3] - 
		6176510*k1[4]*k2[11]*k3[3] - 
		1801220*k1[3]*k2[12]*k3[3] + 
		528600*k1[2]*k2[13]*k3[3] + 
		39600*k1[13]*k2[1]*k3[4] + 
		2114400*k1[12]*k2[2]*k3[4] - 
		2286880*k1[11]*k2[3]*k3[4] - 
		3844880*k1[10]*k2[4]*k3[4] + 
		14573280*k1[9]*k2[5]*k3[4] + 
		1140880*k1[8]*k2[6]*k3[4] - 
		25204600*k1[7]*k2[7]*k3[4] + 
		1140880*k1[6]*k2[8]*k3[4] + 
		14573280*k1[5]*k2[9]*k3[4] - 
		3844880*k1[4]*k2[10]*k3[4] - 
		2286880*k1[3]*k2[11]*k3[4] + 
		2114400*k1[2]*k2[12]*k3[4] + 
		39600*k1[1]*k2[13]*k3[4] - 24750*k1[13]*k3[5] + 
		79200*k1[12]*k2[1]*k3[5] + 
		706950*k1[11]*k2[2]*k3[5] + 
		2267010*k1[10]*k2[3]*k3[5] - 
		1889630*k1[9]*k2[4]*k3[5] - 
		13607910*k1[8]*k2[5]*k3[5] + 
		6781954*k1[7]*k2[6]*k3[5] + 
		6781954*k1[6]*k2[7]*k3[5] - 
		13607910*k1[5]*k2[8]*k3[5] - 
		1889630*k1[4]*k2[9]*k3[5] + 
		2267010*k1[3]*k2[10]*k3[5] + 
		706950*k1[2]*k2[11]*k3[5] + 
		79200*k1[1]*k2[12]*k3[5] - 24750*k2[13]*k3[5] - 
		19800*k1[12]*k3[6] - 95040*k1[11]*k2[1]*k3[6] - 
		3714360*k1[10]*k2[2]*k3[6] + 
		3336012*k1[9]*k2[3]*k3[6] - 
		103848*k1[8]*k2[4]*k3[6] - 
		8005147*k1[7]*k2[5]*k3[6] + 
		2975456*k1[6]*k2[6]*k3[6] - 
		8005147*k1[5]*k2[7]*k3[6] - 
		103848*k1[4]*k2[8]*k3[6] + 
		3336012*k1[3]*k2[9]*k3[6] - 
		3714360*k1[2]*k2[10]*k3[6] - 
		95040*k1[1]*k2[11]*k3[6] - 19800*k2[12]*k3[6] + 
		74250*k1[11]*k3[7] - 237600*k1[10]*k2[1]*k3[7] - 
		2790000*k1[9]*k2[2]*k3[7] + 
		102450*k1[8]*k2[3]*k3[7] + 
		3853430*k1[7]*k2[4]*k3[7] + 
		1589180*k1[6]*k2[5]*k3[7] + 
		1589180*k1[5]*k2[6]*k3[7] + 
		3853430*k1[4]*k2[7]*k3[7] + 
		102450*k1[3]*k2[8]*k3[7] - 
		2790000*k1[2]*k2[9]*k3[7] - 
		237600*k1[1]*k2[10]*k3[7] + 74250*k2[11]*k3[7] + 
		59400*k1[10]*k3[8] + 47520*k1[9]*k2[1]*k3[8] + 
		1153080*k1[8]*k2[2]*k3[8] - 
		815478*k1[7]*k2[3]*k3[8] + 
		1580752*k1[6]*k2[4]*k3[8] + 
		2613184*k1[5]*k2[5]*k3[8] + 
		1580752*k1[4]*k2[6]*k3[8] - 
		815478*k1[3]*k2[7]*k3[8] + 
		1153080*k1[2]*k2[8]*k3[8] + 
		47520*k1[1]*k2[9]*k3[8] + 59400*k2[10]*k3[8] - 
		74250*k1[9]*k3[9] + 237600*k1[8]*k2[1]*k3[9] + 
		1404150*k1[7]*k2[2]*k3[9] - 
		545670*k1[6]*k2[3]*k3[9] + 
		1278130*k1[5]*k2[4]*k3[9] + 
		1278130*k1[4]*k2[5]*k3[9] - 
		545670*k1[3]*k2[6]*k3[9] + 
		1404150*k1[2]*k2[7]*k3[9] + 
		237600*k1[1]*k2[8]*k3[9] - 74250*k2[9]*k3[9] - 
		59400*k1[8]*k3[10] + 31680*k1[7]*k2[1]*k3[10] + 
		426840*k1[6]*k2[2]*k3[10] + 
		51896*k1[5]*k2[3]*k3[10] + 
		254096*k1[4]*k2[4]*k3[10] + 
		51896*k1[3]*k2[5]*k3[10] + 
		426840*k1[2]*k2[6]*k3[10] + 
		31680*k1[1]*k2[7]*k3[10] - 59400*k2[8]*k3[10] + 
		24750*k1[7]*k3[11] - 79200*k1[6]*k2[1]*k3[11] + 
		150300*k1[5]*k2[2]*k3[11] - 
		36110*k1[4]*k2[3]*k3[11] - 
		36110*k1[3]*k2[4]*k3[11] + 
		150300*k1[2]*k2[5]*k3[11] - 
		79200*k1[1]*k2[6]*k3[11] + 24750*k2[7]*k3[11] + 
		19800*k1[6]*k3[12] - 23760*k1[5]*k2[1]*k3[12] + 
		20040*k1[4]*k2[2]*k3[12] - 
		4720*k1[3]*k2[3]*k3[12] + 
		20040*k1[2]*k2[4]*k3[12] - 
		23760*k1[1]*k2[5]*k3[12] + 19800*k2[6]*k3[12])*M_PI*q[10]; 

	kernel_poly[7] = - (22680*k1[13]*k2[4] + 136080*k1[12]*k2[5] + 
		204120*k1[11]*k2[6] - 22680*k1[10]*k2[7] - 
		340200*k1[9]*k2[8] - 340200*k1[8]*k2[9] - 
		22680*k1[7]*k2[10] + 204120*k1[6]*k2[11] + 
		136080*k1[5]*k2[12] + 22680*k1[4]*k2[13] - 
		43380*k1[13]*k2[3]*k3[1] - 285120*k1[12]*k2[4]*k3[1] + 
		385557*k1[11]*k2[5]*k3[1] + 
		2469552*k1[10]*k2[6]*k3[1] - 371787*k1[9]*k2[7]*k3[1] - 
		4257984*k1[8]*k2[8]*k3[1] - 371787*k1[7]*k2[9]*k3[1] + 
		2469552*k1[6]*k2[10]*k3[1] + 
		385557*k1[5]*k2[11]*k3[1] - 285120*k1[4]*k2[12]*k3[1] - 
		43380*k1[3]*k2[13]*k3[1] + 
		264300*k1[13]*k2[2]*k3[2] - 
		913770*k1[12]*k2[3]*k3[2] - 
		3547350*k1[11]*k2[4]*k3[2] + 
		5668020*k1[10]*k2[5]*k3[2] + 
		12684420*k1[9]*k2[6]*k3[2] - 
		14372340*k1[8]*k2[7]*k3[2] - 
		14372340*k1[7]*k2[8]*k3[2] + 
		12684420*k1[6]*k2[9]*k3[2] + 
		5668020*k1[5]*k2[10]*k3[2] - 
		3547350*k1[4]*k2[11]*k3[2] - 
		913770*k1[3]*k2[12]*k3[2] + 
		264300*k1[2]*k2[13]*k3[2] + 
		39600*k1[13]*k2[1]*k3[3] + 
		2114400*k1[12]*k2[2]*k3[3] - 
		2671820*k1[11]*k2[3]*k3[3] - 
		7291120*k1[10]*k2[4]*k3[3] + 
		13049052*k1[9]*k2[5]*k3[3] + 
		5207312*k1[8]*k2[6]*k3[3] - 
		21778976*k1[7]*k2[7]*k3[3] + 
		5207312*k1[6]*k2[8]*k3[3] + 
		13049052*k1[5]*k2[9]*k3[3] - 
		7291120*k1[4]*k2[10]*k3[3] - 
		2671820*k1[3]*k2[11]*k3[3] + 
		2114400*k1[2]*k2[12]*k3[3] + 
		39600*k1[1]*k2[13]*k3[3] - 49500*k1[13]*k3[4] + 
		158400*k1[12]*k2[1]*k3[4] + 
		2924550*k1[11]*k2[2]*k3[4] + 
		487030*k1[10]*k2[3]*k3[4] - 
		8182660*k1[9]*k2[4]*k3[4] - 
		2929880*k1[8]*k2[5]*k3[4] + 
		7750340*k1[7]*k2[6]*k3[4] + 
		7750340*k1[6]*k2[7]*k3[4] - 
		2929880*k1[5]*k2[8]*k3[4] - 
		8182660*k1[4]*k2[9]*k3[4] + 
		487030*k1[3]*k2[10]*k3[4] + 
		2924550*k1[2]*k2[11]*k3[4] + 
		158400*k1[1]*k2[12]*k3[4] - 49500*k2[13]*k3[4] - 
		99000*k1[12]*k3[5] - 2458200*k1[10]*k2[2]*k3[5] + 
		3409720*k1[9]*k2[3]*k3[5] - 
		1810760*k1[8]*k2[4]*k3[5] - 
		5733499*k1[7]*k2[5]*k3[5] + 
		10495776*k1[6]*k2[6]*k3[5] - 
		5733499*k1[5]*k2[7]*k3[5] - 
		1810760*k1[4]*k2[8]*k3[5] + 
		3409720*k1[3]*k2[9]*k3[5] - 
		2458200*k1[2]*k2[10]*k3[5] - 99000*k2[12]*k3[5] + 
		118800*k1[11]*k3[6] - 459360*k1[10]*k2[1]*k3[6] - 
		6015840*k1[9]*k2[2]*k3[6] + 
		1440588*k1[8]*k2[3]*k3[6] + 
		5736868*k1[7]*k2[4]*k3[6] - 
		1497356*k1[6]*k2[5]*k3[6] - 
		1497356*k1[5]*k2[6]*k3[6] + 
		5736868*k1[4]*k2[7]*k3[6] + 
		1440588*k1[3]*k2[8]*k3[6] - 
		6015840*k1[2]*k2[9]*k3[6] - 
		459360*k1[1]*k2[10]*k3[6] + 118800*k2[11]*k3[6] + 
		297000*k1[10]*k3[7] - 237600*k1[9]*k2[1]*k3[7] - 
		1089000*k1[8]*k2[2]*k3[7] - 
		311050*k1[7]*k2[3]*k3[7] + 
		3376880*k1[6]*k2[4]*k3[7] + 
		531960*k1[5]*k2[5]*k3[7] + 
		3376880*k1[4]*k2[6]*k3[7] - 
		311050*k1[3]*k2[7]*k3[7] - 
		1089000*k1[2]*k2[8]*k3[7] - 
		237600*k1[1]*k2[9]*k3[7] + 297000*k2[10]*k3[7] - 
		59400*k1[9]*k3[8] + 427680*k1[8]*k2[1]*k3[8] + 
		2395920*k1[7]*k2[2]*k3[8] - 
		957872*k1[6]*k2[3]*k3[8] + 
		901148*k1[5]*k2[4]*k3[8] + 
		901148*k1[4]*k2[5]*k3[8] - 
		957872*k1[3]*k2[6]*k3[8] + 
		2395920*k1[2]*k2[7]*k3[8] + 
		427680*k1[1]*k2[8]*k3[8] - 59400*k2[9]*k3[8] - 
		297000*k1[8]*k3[9] + 316800*k1[7]*k2[1]*k3[9] + 
		1332600*k1[6]*k2[2]*k3[9] - 
		314780*k1[5]*k2[3]*k3[9] + 
		303120*k1[4]*k2[4]*k3[9] - 
		314780*k1[3]*k2[5]*k3[9] + 
		1332600*k1[2]*k2[6]*k3[9] + 
		316800*k1[1]*k2[7]*k3[9] - 297000*k2[8]*k3[9] - 
		39600*k1[7]*k3[10] - 110880*k1[6]*k2[1]*k3[10] + 
		426060*k1[5]*k2[2]*k3[10] - 
		106126*k1[4]*k2[3]*k3[10] - 
		106126*k1[3]*k2[4]*k3[10] + 
		426060*k1[2]*k2[5]*k3[10] - 
		110880*k1[1]*k2[6]*k3[10] - 39600*k2[7]*k3[10] + 
		99000*k1[6]*k3[11] - 118800*k1[5]*k2[1]*k3[11] + 
		100200*k1[4]*k2[2]*k3[11] - 
		24440*k1[3]*k2[3]*k3[11] + 
		100200*k1[2]*k2[4]*k3[11] - 
		118800*k1[1]*k2[5]*k3[11] + 99000*k2[6]*k3[11] + 
		29700*k1[5]*k3[12] - 15840*k1[4]*k2[1]*k3[12] + 
		5010*k1[3]*k2[2]*k3[12] + 
		5010*k1[2]*k2[3]*k3[12] - 15840*k1[1]*k2[4]*k3[12] + 
		29700*k2[5]*k3[12])*M_PI*q[11]; 

	kernel_poly[8] = -(5670*k1[13]*k2[3] + 90720*k1[12]*k2[4] + 
		334530*k1[11]*k2[5] + 362880*k1[10]*k2[6] - 
		340200*k1[9]*k2[7] - 907200*k1[8]*k2[8] - 
		340200*k1[7]*k2[9] + 362880*k1[6]*k2[10] + 
		334530*k1[5]*k2[11] + 90720*k1[4]*k2[12] + 
		5670*k1[3]*k2[13] + 52860*k1[13]*k2[2]*k3[1] - 
		174690*k1[12]*k2[3]*k3[1] - 562302*k1[11]*k2[4]*k3[1] + 
		1766628*k1[10]*k2[5]*k3[1] + 
		2915892*k1[9]*k2[6]*k3[1] - 3932868*k1[8]*k2[7]*k3[1] - 
		3932868*k1[7]*k2[8]*k3[1] + 2915892*k1[6]*k2[9]*k3[1] + 
		1766628*k1[5]*k2[10]*k3[1] - 
		562302*k1[4]*k2[11]*k3[1] - 174690*k1[3]*k2[12]*k3[1] + 
		52860*k1[2]*k2[13]*k3[1] + 19800*k1[13]*k2[1]*k3[2] + 
		1057200*k1[12]*k2[2]*k3[2] - 
		1475325*k1[11]*k2[3]*k3[2] - 
		5266200*k1[10]*k2[4]*k3[2] + 
		3901830*k1[9]*k2[5]*k3[2] + 
		4002360*k1[8]*k2[6]*k3[2] - 
		6126150*k1[7]*k2[7]*k3[2] + 
		4002360*k1[6]*k2[8]*k3[2] + 
		3901830*k1[5]*k2[9]*k3[2] - 
		5266200*k1[4]*k2[10]*k3[2] - 
		1475325*k1[3]*k2[11]*k3[2] + 
		1057200*k1[2]*k2[12]*k3[2] + 
		19800*k1[1]*k2[13]*k3[2] - 49500*k1[13]*k3[3] + 
		158400*k1[12]*k2[1]*k3[3] + 
		3327390*k1[11]*k2[2]*k3[3] - 
		1163050*k1[10]*k2[3]*k3[3] - 
		13226372*k1[9]*k2[4]*k3[3] - 
		1101952*k1[8]*k2[5]*k3[3] + 
		10843876*k1[7]*k2[6]*k3[3] + 
		10843876*k1[6]*k2[7]*k3[3] - 
		1101952*k1[5]*k2[8]*k3[3] - 
		13226372*k1[4]*k2[9]*k3[3] - 
		1163050*k1[3]*k2[10]*k3[3] + 
		3327390*k1[2]*k2[11]*k3[3] + 
		158400*k1[1]*k2[12]*k3[3] - 49500*k2[13]*k3[3] - 
		198000*k1[12]*k3[4] + 178200*k1[11]*k2[1]*k3[4] + 
		1126200*k1[10]*k2[2]*k3[4] + 
		1421960*k1[9]*k2[3]*k3[4] - 
		7065440*k1[8]*k2[4]*k3[4] - 
		301490*k1[7]*k2[5]*k3[4] + 
		17206320*k1[6]*k2[6]*k3[4] - 
		301490*k1[5]*k2[7]*k3[4] - 
		7065440*k1[4]*k2[8]*k3[4] + 
		1421960*k1[3]*k2[9]*k3[4] + 
		1126200*k1[2]*k2[10]*k3[4] + 
		178200*k1[1]*k2[11]*k3[4] - 198000*k2[12]*k3[4] - 
		396000*k1[10]*k2[1]*k3[5] - 
		5360160*k1[9]*k2[2]*k3[5] + 
		1994620*k1[8]*k2[3]*k3[5] + 
		7195124*k1[7]*k2[4]*k3[5] + 
		906244*k1[6]*k2[5]*k3[5] + 
		906244*k1[5]*k2[6]*k3[5] + 
		7195124*k1[4]*k2[7]*k3[5] + 
		1994620*k1[3]*k2[8]*k3[5] - 
		5360160*k1[2]*k2[9]*k3[5] - 
		396000*k1[1]*k2[10]*k3[5] + 574200*k1[10]*k3[6] - 
		649440*k1[9]*k2[1]*k3[6] - 
		4645800*k1[8]*k2[2]*k3[6] + 
		955267*k1[7]*k2[3]*k3[6] + 
		5839000*k1[6]*k2[4]*k3[6] - 
		1013844*k1[5]*k2[5]*k3[6] + 
		5839000*k1[4]*k2[6]*k3[6] + 
		955267*k1[3]*k2[7]*k3[6] - 
		4645800*k1[2]*k2[8]*k3[6] - 
		649440*k1[1]*k2[9]*k3[6] + 574200*k2[10]*k3[6] + 
		297000*k1[9]*k3[7] + 237600*k1[8]*k2[1]*k3[7] + 
		1026960*k1[7]*k2[2]*k3[7] - 
		515560*k1[6]*k2[3]*k3[7] + 
		712580*k1[5]*k2[4]*k3[7] + 
		712580*k1[4]*k2[5]*k3[7] - 
		515560*k1[3]*k2[6]*k3[7] + 
		1026960*k1[2]*k2[7]*k3[7] + 
		237600*k1[1]*k2[8]*k3[7] + 297000*k2[9]*k3[7] - 
		534600*k1[8]*k3[8] + 681120*k1[7]*k2[1]*k3[8] + 
		2206920*k1[6]*k2[2]*k3[8] - 
		754228*k1[5]*k2[3]*k3[8] + 
		274240*k1[4]*k2[4]*k3[8] - 
		754228*k1[3]*k2[5]*k3[8] + 
		2206920*k1[2]*k2[6]*k3[8] + 
		681120*k1[1]*k2[7]*k3[8] - 534600*k2[8]*k3[8] - 
		396000*k1[7]*k3[9] + 79200*k1[6]*k2[1]*k3[9] + 
		927900*k1[5]*k2[2]*k3[9] - 
		279270*k1[4]*k2[3]*k3[9] - 
		279270*k1[3]*k2[4]*k3[9] + 
		927900*k1[2]*k2[5]*k3[9] + 79200*k1[1]*k2[6]*k3[9] - 
		396000*k2[7]*k3[9] + 138600*k1[6]*k3[10] - 
		225720*k1[5]*k2[1]*k3[10] + 
		255480*k1[4]*k2[2]*k3[10] - 
		68944*k1[3]*k2[3]*k3[10] + 
		255480*k1[2]*k2[4]*k3[10] - 
		225720*k1[1]*k2[5]*k3[10] + 138600*k2[6]*k3[10] + 
		148500*k1[5]*k3[11] - 79200*k1[4]*k2[1]*k3[11] + 
		25050*k1[3]*k2[2]*k3[11] + 
		25050*k1[2]*k2[3]*k3[11] - 
		79200*k1[1]*k2[4]*k3[11] + 148500*k2[5]*k3[11] + 
		19800*k1[4]*k3[12] - 3960*k1[3]*k2[1]*k3[12] - 
		3960*k1[1]*k2[3]*k3[12] + 19800*k2[4]*k3[12])*M_PI*q[12];

	kernel_poly[9] = - (22680*k1[12]*k2[3] + 226800*k1[11]*k2[4] + 
		657720*k1[10]*k2[5] + 249480*k1[9]*k2[6] - 
		1156680*k1[8]*k2[7] - 1156680*k1[7]*k2[8] + 
		249480*k1[6]*k2[9] + 657720*k1[5]*k2[10] + 
		226800*k1[4]*k2[11] + 22680*k1[3]*k2[12] + 
		3960*k1[13]*k2[1]*k3[1] + 211440*k1[12]*k2[2]*k3[1] - 
		258273*k1[11]*k2[3]*k3[1] - 625848*k1[10]*k2[4]*k3[1] + 
		1641198*k1[9]*k2[5]*k3[1] + 469848*k1[8]*k2[6]*k3[1] - 
		2832990*k1[7]*k2[7]*k3[1] + 469848*k1[6]*k2[8]*k3[1] + 
		1641198*k1[5]*k2[9]*k3[1] - 625848*k1[4]*k2[10]*k3[1] - 
		258273*k1[3]*k2[11]*k3[1] + 211440*k1[2]*k2[12]*k3[1] + 
		3960*k1[1]*k2[13]*k3[1] - 24750*k1[13]*k3[2] + 
		79200*k1[12]*k2[1]*k3[2] + 
		1714050*k1[11]*k2[2]*k3[2] - 
		1085250*k1[10]*k2[3]*k3[2] - 
		8968380*k1[9]*k2[4]*k3[2] - 
		1557810*k1[8]*k2[5]*k3[2] + 
		8446860*k1[7]*k2[6]*k3[2] + 
		8446860*k1[6]*k2[7]*k3[2] - 
		1557810*k1[5]*k2[8]*k3[2] - 
		8968380*k1[4]*k2[9]*k3[2] - 
		1085250*k1[3]*k2[10]*k3[2] + 
		1714050*k1[2]*k2[11]*k3[2] + 
		79200*k1[1]*k2[12]*k3[2] - 24750*k2[13]*k3[2] - 
		198000*k1[12]*k3[3] + 225720*k1[11]*k2[1]*k3[3] + 
		2737560*k1[10]*k2[2]*k3[3] - 
		995588*k1[9]*k2[3]*k3[3] - 
		12012928*k1[8]*k2[4]*k3[3] + 
		189014*k1[7]*k2[5]*k3[3] + 
		18454704*k1[6]*k2[6]*k3[3] + 
		189014*k1[5]*k2[7]*k3[3] - 
		12012928*k1[4]*k2[8]*k3[3] - 
		995588*k1[3]*k2[9]*k3[3] + 
		2737560*k1[2]*k2[10]*k3[3] + 
		225720*k1[1]*k2[11]*k3[3] - 198000*k2[12]*k3[3] - 
		222750*k1[11]*k3[4] - 79200*k1[10]*k2[1]*k3[4] - 
		1150800*k1[9]*k2[2]*k3[4] + 
		726490*k1[8]*k2[3]*k3[4] + 
		3558700*k1[7]*k2[4]*k3[4] + 
		3244480*k1[6]*k2[5]*k3[4] + 
		3244480*k1[5]*k2[6]*k3[4] + 
		3558700*k1[4]*k2[7]*k3[4] + 
		726490*k1[3]*k2[8]*k3[4] - 
		1150800*k1[2]*k2[9]*k3[4] - 
		79200*k1[1]*k2[10]*k3[4] - 222750*k2[11]*k3[4] + 
		495000*k1[10]*k3[5] - 681120*k1[9]*k2[1]*k3[5] - 
		4920840*k1[8]*k2[2]*k3[5] + 
		2088971*k1[7]*k2[3]*k3[5] + 
		7136376*k1[6]*k2[4]*k3[5] - 
		220564*k1[5]*k2[5]*k3[5] + 
		7136376*k1[4]*k2[6]*k3[5] + 
		2088971*k1[3]*k2[7]*k3[5] - 
		4920840*k1[2]*k2[8]*k3[5] - 
		681120*k1[1]*k2[9]*k3[5] + 495000*k2[10]*k3[5] + 
		811800*k1[9]*k3[6] - 237600*k1[8]*k2[1]*k3[6] - 
		1992600*k1[7]*k2[2]*k3[6] + 
		695080*k1[6]*k2[3]*k3[6] + 
		950920*k1[5]*k2[4]*k3[6] + 
		950920*k1[4]*k2[5]*k3[6] + 
		695080*k1[3]*k2[6]*k3[6] - 
		1992600*k1[2]*k2[7]*k3[6] - 
		237600*k1[1]*k2[8]*k3[6] + 811800*k2[9]*k3[6] - 
		297000*k1[8]*k3[7] + 649440*k1[7]*k2[1]*k3[7] + 
		1496040*k1[6]*k2[2]*k3[7] - 
		680650*k1[5]*k2[3]*k3[7] - 
		157760*k1[4]*k2[4]*k3[7] - 
		680650*k1[3]*k2[5]*k3[7] + 
		1496040*k1[2]*k2[6]*k3[7] + 
		649440*k1[1]*k2[7]*k3[7] - 297000*k2[8]*k3[7] - 
		851400*k1[7]*k3[8] + 396000*k1[6]*k2[1]*k3[8] + 
		1365480*k1[5]*k2[2]*k3[8] - 
		444440*k1[4]*k2[3]*k3[8] - 
		444440*k1[3]*k2[4]*k3[8] + 
		1365480*k1[2]*k2[5]*k3[8] + 
		396000*k1[1]*k2[6]*k3[8] - 851400*k2[7]*k3[8] - 
		99000*k1[6]*k3[9] - 178200*k1[5]*k2[1]*k3[9] + 
		475800*k1[4]*k2[2]*k3[9] - 
		158580*k1[3]*k2[3]*k3[9] + 
		475800*k1[2]*k2[4]*k3[9] - 
		178200*k1[1]*k2[5]*k3[9] - 99000*k2[6]*k3[9] + 
		282150*k1[5]*k3[10] - 158400*k1[4]*k2[1]*k3[10] + 
		63870*k1[3]*k2[2]*k3[10] + 
		63870*k1[2]*k2[3]*k3[10] - 
		158400*k1[1]*k2[4]*k3[10] + 282150*k2[5]*k3[10] + 
		99000*k1[4]*k3[11] - 19800*k1[3]*k2[1]*k3[11] - 
		19800*k1[1]*k2[3]*k3[11] + 99000*k2[4]*k3[11] + 
		4950*k1[3]*k3[12] + 4950*k2[3]*k3[12])*M_PI*q[13];

      kernel_poly[10] = -  (56700*k1[11]*k2[3] + 453600*k1[10]*k2[4] + 
		771120*k1[9]*k2[5] - 453600*k1[8]*k2[6] - 
		1655640*k1[7]*k2[7] - 453600*k1[6]*k2[8] + 
		771120*k1[5]*k2[9] + 453600*k1[4]*k2[10] + 
		56700*k1[3]*k2[11] - 4950*k1[13]*k3[1] + 
		15840*k1[12]*k2[1]*k3[1] + 342810*k1[11]*k2[2]*k3[1] - 
		110202*k1[10]*k2[3]*k3[1] - 1180812*k1[9]*k2[4]*k3[1] + 
		160182*k1[8]*k2[5]*k3[1] + 751932*k1[7]*k2[6]*k3[1] + 
		751932*k1[6]*k2[7]*k3[1] + 160182*k1[5]*k2[8]*k3[1] - 
		1180812*k1[4]*k2[9]*k3[1] - 110202*k1[3]*k2[10]*k3[1] + 
		342810*k1[2]*k2[11]*k3[1] + 15840*k1[1]*k2[12]*k3[1] - 
		4950*k2[13]*k3[1] - 99000*k1[12]*k3[2] + 
		118800*k1[11]*k2[1]*k3[2] + 
		1570200*k1[10]*k2[2]*k3[2] - 
		1231170*k1[9]*k2[3]*k3[2] - 
		7791240*k1[8]*k2[4]*k3[2] + 
		398265*k1[7]*k2[5]*k3[2] + 
		11279280*k1[6]*k2[6]*k3[2] + 
		398265*k1[5]*k2[7]*k3[2] - 
		7791240*k1[4]*k2[8]*k3[2] - 
		1231170*k1[3]*k2[9]*k3[2] + 
		1570200*k1[2]*k2[10]*k3[2] + 
		118800*k1[1]*k2[11]*k3[2] - 99000*k2[12]*k3[2] - 
		282150*k1[11]*k3[3] + 110880*k1[10]*k2[1]*k3[3] + 
		1423920*k1[9]*k2[2]*k3[3] - 
		1194262*k1[8]*k2[3]*k3[3] - 
		2374372*k1[7]*k2[4]*k3[3] + 
		2353016*k1[6]*k2[5]*k3[3] + 
		2353016*k1[5]*k2[6]*k3[3] - 
		2374372*k1[4]*k2[7]*k3[3] - 
		1194262*k1[3]*k2[8]*k3[3] + 
		1423920*k1[2]*k2[9]*k3[3] + 
		110880*k1[1]*k2[10]*k3[3] - 282150*k2[11]*k3[3] + 
		99000*k1[10]*k3[4] - 316800*k1[9]*k2[1]*k3[4] - 
		1776600*k1[8]*k2[2]*k3[4] + 
		1541200*k1[7]*k2[3]*k3[4] + 
		4099680*k1[6]*k2[4]*k3[4] + 
		509720*k1[5]*k2[5]*k3[4] + 
		4099680*k1[4]*k2[6]*k3[4] + 
		1541200*k1[3]*k2[7]*k3[4] - 
		1776600*k1[2]*k2[8]*k3[4] - 
		316800*k1[1]*k2[9]*k3[4] + 99000*k2[10]*k3[4] + 
		851400*k1[9]*k3[5] - 427680*k1[8]*k2[1]*k3[5] - 
		2973240*k1[7]*k2[2]*k3[5] + 
		1586904*k1[6]*k2[3]*k3[5] + 
		1171224*k1[5]*k2[4]*k3[5] + 
		1171224*k1[4]*k2[5]*k3[5] + 
		1586904*k1[3]*k2[6]*k3[5] - 
		2973240*k1[2]*k2[7]*k3[5] - 
		427680*k1[1]*k2[8]*k3[5] + 851400*k2[9]*k3[5] + 
		297000*k1[8]*k3[6] + 237600*k1[7]*k2[1]*k3[6] - 
		444600*k1[6]*k2[2]*k3[6] - 
		91250*k1[5]*k2[3]*k3[6] - 
		763440*k1[4]*k2[4]*k3[6] - 
		91250*k1[3]*k2[5]*k3[6] - 
		444600*k1[2]*k2[6]*k3[6] + 
		237600*k1[1]*k2[7]*k3[6] + 297000*k2[8]*k3[6] - 
		811800*k1[7]*k3[7] + 459360*k1[6]*k2[1]*k3[7] + 
		1087560*k1[5]*k2[2]*k3[7] - 
		454520*k1[4]*k2[3]*k3[7] - 
		454520*k1[3]*k2[4]*k3[7] + 
		1087560*k1[2]*k2[5]*k3[7] + 
		459360*k1[1]*k2[6]*k3[7] - 811800*k2[7]*k3[7] - 
		495000*k1[6]*k3[8] + 651000*k1[4]*k2[2]*k3[8] - 
		239360*k1[3]*k2[3]*k3[8] + 
		651000*k1[2]*k2[4]*k3[8] - 495000*k2[6]*k3[8] + 
		222750*k1[5]*k3[9] - 158400*k1[4]*k2[1]*k3[9] + 
		118950*k1[3]*k2[2]*k3[9] + 
		118950*k1[2]*k2[3]*k3[9] - 
		158400*k1[1]*k2[4]*k3[9] + 222750*k2[5]*k3[9] + 
		198000*k1[4]*k3[10] - 39600*k1[3]*k2[1]*k3[10] - 
		39600*k1[1]*k2[3]*k3[10] + 198000*k2[4]*k3[10] + 
		24750*k1[3]*k3[11] + 24750*k2[3]*k3[11])*M_PI*q[14];

	kernel_poly[11] = - (113400*k1[10]*k2[3] + 567000*k1[9]*k2[4] + 
		340200*k1[8]*k2[5] - 1020600*k1[7]*k2[6] - 
		1020600*k1[6]*k2[7] + 340200*k1[5]*k2[8] + 
		567000*k1[4]*k2[9] + 113400*k1[3]*k2[10] - 
		19800*k1[12]*k3[1] + 23760*k1[11]*k2[1]*k3[1] + 
		314040*k1[10]*k2[2]*k3[1] - 93018*k1[9]*k2[3]*k3[1] - 
		1114728*k1[8]*k2[4]*k3[1] + 59493*k1[7]*k2[5]*k3[1] + 
		1610736*k1[6]*k2[6]*k3[1] + 59493*k1[5]*k2[7]*k3[1] - 
		1114728*k1[4]*k2[8]*k3[1] - 93018*k1[3]*k2[9]*k3[1] + 
		314040*k1[2]*k2[10]*k3[1] + 23760*k1[1]*k2[11]*k3[1] - 
		19800*k2[12]*k3[1] - 148500*k1[11]*k3[2] + 
		79200*k1[10]*k2[1]*k3[2] + 
		1033800*k1[9]*k2[2]*k3[2] - 
		1128810*k1[8]*k2[3]*k3[2] - 
		2262510*k1[7]*k2[4]*k3[2] + 
		1481820*k1[6]*k2[5]*k3[2] + 
		1481820*k1[5]*k2[6]*k3[2] - 
		2262510*k1[4]*k2[7]*k3[2] - 
		1128810*k1[3]*k2[8]*k3[2] + 
		1033800*k1[2]*k2[9]*k3[2] + 
		79200*k1[1]*k2[10]*k3[2] - 148500*k2[11]*k3[2] - 
		138600*k1[10]*k3[3] - 31680*k1[9]*k2[1]*k3[3] + 
		465480*k1[8]*k2[2]*k3[3] + 
		5612*k1[7]*k2[3]*k3[3] - 
		156288*k1[6]*k2[4]*k3[3] + 
		184864*k1[5]*k2[5]*k3[3] - 
		156288*k1[4]*k2[6]*k3[3] + 
		5612*k1[3]*k2[7]*k3[3] + 
		465480*k1[2]*k2[8]*k3[3] - 31680*k1[1]*k2[9]*k3[3] - 
		138600*k2[10]*k3[3] + 396000*k1[9]*k3[4] - 
		237600*k1[8]*k2[1]*k3[4] - 
		1429650*k1[7]*k2[2]*k3[4] + 
		1096170*k1[6]*k2[3]*k3[4] + 
		630720*k1[5]*k2[4]*k3[4] + 
		630720*k1[4]*k2[5]*k3[4] + 
		1096170*k1[3]*k2[6]*k3[4] - 
		1429650*k1[2]*k2[7]*k3[4] - 
		237600*k1[1]*k2[8]*k3[4] + 396000*k2[9]*k3[4] + 
		534600*k1[8]*k3[5] - 47520*k1[7]*k2[1]*k3[5] - 
		1350360*k1[6]*k2[2]*k3[5] + 
		337446*k1[5]*k2[3]*k3[5] - 
		969264*k1[4]*k2[4]*k3[5] + 
		337446*k1[3]*k2[5]*k3[5] - 
		1350360*k1[2]*k2[6]*k3[5] - 
		47520*k1[1]*k2[7]*k3[5] + 534600*k2[8]*k3[5] - 
		297000*k1[7]*k3[6] + 237600*k1[6]*k2[1]*k3[6] + 
		233100*k1[5]*k2[2]*k3[6] - 
		301110*k1[4]*k2[3]*k3[6] - 
		301110*k1[3]*k2[4]*k3[6] + 
		233100*k1[2]*k2[5]*k3[6] + 
		237600*k1[1]*k2[6]*k3[6] - 297000*k2[7]*k3[6] - 
		574200*k1[6]*k3[7] + 95040*k1[5]*k2[1]*k3[7] + 
		570840*k1[4]*k2[2]*k3[7] - 
		217400*k1[3]*k2[3]*k3[7] + 
		570840*k1[2]*k2[4]*k3[7] + 95040*k1[1]*k2[5]*k3[7] - 
		574200*k2[6]*k3[7] - 79200*k1[4]*k2[1]*k3[8] + 
		162750*k1[3]*k2[2]*k3[8] + 
		162750*k1[2]*k2[3]*k3[8] - 79200*k1[1]*k2[4]*k3[8] + 
		198000*k1[4]*k3[9] - 39600*k1[3]*k2[1]*k3[9] - 
		39600*k1[1]*k2[3]*k3[9] + 198000*k2[4]*k3[9] + 
		49500*k1[3]*k3[10] + 49500*k2[3]*k3[10])*M_PI*q[15] - 
		(141750*k1[9]*k2[3] + 362880*k1[8]*k2[4] - 
		141750*k1[7]*k2[5] - 725760*k1[6]*k2[6] - 
		141750*k1[5]*k2[7] + 362880*k1[4]*k2[8] + 
		141750*k1[3]*k2[9] - 29700*k1[11]*k3[1] + 
		15840*k1[10]*k2[1]*k3[1] + 206760*k1[9]*k2[2]*k3[1] - 
		114882*k1[8]*k2[3]*k3[1] - 281142*k1[7]*k2[4]*k3[1] + 
		195564*k1[6]*k2[5]*k3[1] + 195564*k1[5]*k2[6]*k3[1] - 
		281142*k1[4]*k2[7]*k3[1] - 114882*k1[3]*k2[8]*k3[1] + 
		206760*k1[2]*k2[9]*k3[1] + 15840*k1[1]*k2[10]*k3[1] - 
		29700*k2[11]*k3[1] - 99000*k1[10]*k3[2] + 
		19800*k1[9]*k2[1]*k3[2] + 513000*k1[8]*k2[2]*k3[2] - 
		272565*k1[7]*k2[3]*k3[2] - 
		655920*k1[6]*k2[4]*k3[2] + 
		118080*k1[5]*k2[5]*k3[2] - 
		655920*k1[4]*k2[6]*k3[2] - 
		272565*k1[3]*k2[7]*k3[2] + 
		513000*k1[2]*k2[8]*k3[2] + 19800*k1[1]*k2[9]*k3[2] - 
		99000*k2[10]*k3[2] + 39600*k1[9]*k3[3] - 
		47520*k1[8]*k2[1]*k3[3] - 80730*k1[7]*k2[2]*k3[3] + 
		88218*k1[6]*k2[3]*k3[3] - 
		35112*k1[5]*k2[4]*k3[3] - 
		35112*k1[4]*k2[5]*k3[3] + 
		88218*k1[3]*k2[6]*k3[3] - 
		80730*k1[2]*k2[7]*k3[3] - 47520*k1[1]*k2[8]*k3[3] + 
		39600*k2[9]*k3[3] + 297000*k1[8]*k3[4] - 
		59400*k1[7]*k2[1]*k3[4] - 788400*k1[6]*k2[2]*k3[4] + 
		251430*k1[5]*k2[3]*k3[4] - 
		606960*k1[4]*k2[4]*k3[4] + 
		251430*k1[3]*k2[5]*k3[4] - 
		788400*k1[2]*k2[6]*k3[4] - 59400*k1[1]*k2[7]*k3[4] + 
		297000*k2[8]*k3[4] + 59400*k1[7]*k3[5] + 
		47520*k1[6]*k2[1]*k3[5] - 268740*k1[5]*k2[2]*k3[5] - 
		167166*k1[4]*k2[3]*k3[5] - 
		167166*k1[3]*k2[4]*k3[5] - 
		268740*k1[2]*k2[5]*k3[5] + 47520*k1[1]*k2[6]*k3[5] + 
		59400*k2[7]*k3[5] - 297000*k1[6]*k3[6] + 
		59400*k1[5]*k2[1]*k3[6] + 275400*k1[4]*k2[2]*k3[6] - 
		102840*k1[3]*k2[3]*k3[6] + 
		275400*k1[2]*k2[4]*k3[6] + 59400*k1[1]*k2[5]*k3[6] - 
		297000*k2[6]*k3[6] - 118800*k1[5]*k3[7] - 
		15840*k1[4]*k2[1]*k3[7] + 142710*k1[3]*k2[2]*k3[7] + 
		142710*k1[2]*k2[3]*k3[7] - 15840*k1[1]*k2[4]*k3[7] - 
		118800*k2[5]*k3[7] + 99000*k1[4]*k3[8] - 
		19800*k1[3]*k2[1]*k3[8] - 19800*k1[1]*k2[3]*k3[8] + 
		99000*k2[4]*k3[8] + 49500*k1[3]*k3[9] + 
		49500*k2[3]*k3[9])*M_PI*q[16];

	kernel_poly[12] = -  (90720*k1[8]*k2[3] + 90720*k1[7]*k2[4] - 
		181440*k1[6]*k2[5] - 181440*k1[5]*k2[6] + 
		90720*k1[4]*k2[7] + 90720*k1[3]*k2[8] - 
		19800*k1[10]*k3[1] + 3960*k1[9]*k2[1]*k3[1] + 
		102600*k1[8]*k2[2]*k3[1] - 11673*k1[7]*k2[3]*k3[1] - 
		82800*k1[6]*k2[4]*k3[1] + 13536*k1[5]*k2[5]*k3[1] - 
		82800*k1[4]*k2[6]*k3[1] - 11673*k1[3]*k2[7]*k3[1] + 
		102600*k1[2]*k2[8]*k3[1] + 3960*k1[1]*k2[9]*k3[1] - 
		19800*k2[10]*k3[1] - 24750*k1[9]*k3[2] + 
		128250*k1[7]*k2[2]*k3[2] - 
		93330*k1[6]*k2[3]*k3[2] - 
		131130*k1[5]*k2[4]*k3[2] - 
		131130*k1[4]*k2[5]*k3[2] - 
		93330*k1[3]*k2[6]*k3[2] + 
		128250*k1[2]*k2[7]*k3[2] - 24750*k2[9]*k3[2] + 
		59400*k1[8]*k3[3] - 11880*k1[7]*k2[1]*k3[3] - 
		157680*k1[6]*k2[2]*k3[3] + 
		38232*k1[5]*k2[3]*k3[3] - 
		97200*k1[4]*k2[4]*k3[3] + 
		38232*k1[3]*k2[5]*k3[3] - 
		157680*k1[2]*k2[6]*k3[3] - 11880*k1[1]*k2[7]*k3[3] + 
		59400*k2[8]*k3[3] + 74250*k1[7]*k3[4] - 
		197100*k1[5]*k2[2]*k3[4] - 
		90990*k1[4]*k2[3]*k3[4] - 
		90990*k1[3]*k2[4]*k3[4] - 
		197100*k1[2]*k2[5]*k3[4] + 74250*k2[7]*k3[4] - 
		59400*k1[6]*k3[5] + 11880*k1[5]*k2[1]*k3[5] + 
		55080*k1[4]*k2[2]*k3[5] - 
		23004*k1[3]*k2[3]*k3[5] + 
		55080*k1[2]*k2[4]*k3[5] + 11880*k1[1]*k2[5]*k3[5] - 
		59400*k2[6]*k3[5] - 74250*k1[5]*k3[6] + 
		68850*k1[3]*k2[2]*k3[6] + 
		68850*k1[2]*k2[3]*k3[6] - 74250*k2[5]*k3[6] + 
		19800*k1[4]*k3[7] - 3960*k1[3]*k2[1]*k3[7] - 
		3960*k1[1]*k2[3]*k3[7] + 19800*k2[4]*k3[7] + 
		24750*k1[3]*k3[8] + 24750*k2[3]*k3[8])*M_PI*q[17] - 
		(22680*k1[7]*k2[3] - 45360*k1[5]*k2[5] + 
		22680*k1[3]*k2[7] - 4950*k1[9]*k3[1] + 
		25650*k1[7]*k2[2]*k3[1] - 6570*k1[6]*k2[3]*k3[1] - 
		14130*k1[5]*k2[4]*k3[1] - 14130*k1[4]*k2[5]*k3[1] - 
		6570*k1[3]*k2[6]*k3[1] + 25650*k1[2]*k2[7]*k3[1] - 
		4950*k2[9]*k3[1] - 15120*k1[5]*k2[3]*k3[2] - 
		15120*k1[3]*k2[5]*k3[2] + 14850*k1[7]*k3[3] - 
		39420*k1[5]*k2[2]*k3[3] - 
		12150*k1[4]*k2[3]*k3[3] - 
		12150*k1[3]*k2[4]*k3[3] - 
		39420*k1[2]*k2[5]*k3[3] + 14850*k2[7]*k3[3] - 
		7560*k1[3]*k2[3]*k3[4] - 14850*k1[5]*k3[5] + 
		13770*k1[3]*k2[2]*k3[5] + 
		13770*k1[2]*k2[3]*k3[5] - 14850*k2[5]*k3[5] + 
		4950*k1[3]*k3[7] + 4950*k2[3]*k3[7])*M_PI*q[18];

	kernel_beta[0] = (M_PI*((-840*k1[10]*k2[7]*
		(k2[2] - q[2])*(k2[2] - q[2])*
		(-2*k3[4] - 7*k3[2]*q[2] + 9*q[4]))/
		my_sqrt(k3[2]*(k2[2] - q[2]) + 
		q[2]*(k1[2] - k2[2] + q[2])) - 
		(840*k1[7]*k2[10]*(k1[2] - q[2])*(k1[2] - q[2])*
		(-2*k3[4] - 7*k3[2]*q[2] + 9*q[4]))/
		my_sqrt(k3[2]*(k1[2] - q[2]) + 
		q[2]*(-k1[2] + k2[2] + q[2])) + 
		(4320*k1[7]*k2[7]*k3[3]*(k1[2] - q[2])*(k1[2] - q[2])*
		(k2[2] - q[2])*(k2[2] - q[2]))/
		my_sqrt(k1[2]*(k2[2] - q[2]) + 
		q[2]*(-k2[2] + k3[2] + q[2])) - 
		(4320*k1[7]*k2[7]*k3[3]*(k1[2] - q[2])*(k1[2] - q[2])*
		(k2[2] - q[2])*(k2[2] - q[2])*
		my_pow(1 - my_sqrt(k1[2]*k2[2] + 
		(-k1[2] - k2[2] + k3[2])*q[2] + q[4])/
		(k3[1]*q[1]),2))/
		(my_sqrt(k1[2]*(k2[2] - q[2]) + 
		q[2]*(-k2[2] + k3[2] + q[2]))*
		my_pow(1 + my_sqrt(k1[2]*k2[2] + 
		(-k1[2] - k2[2] + k3[2])*q[2] + q[4])/
		(k3[1]*q[1]),2)) + 
		(840*k1[7]*k2[10]*(k1[2] - q[2])*(k1[2] - q[2])*
		(-2*k3[4] - 7*k3[2]*q[2] + 9*q[4])*
		my_pow(1 - my_sqrt(k1[2]*k3[2] - 
		(k1[2] - k2[2] + k3[2])*q[2] + q[4])/
		(k2[1]*q[1]),2))/
		(my_sqrt(k3[2]*(k1[2] - q[2]) + 
		q[2]*(-k1[2] + k2[2] + q[2]))*
		my_pow(1 + my_sqrt(k1[2]*k3[2] - 
		(k1[2] - k2[2] + k3[2])*q[2] + q[4])/
		(k2[1]*q[1]),2)) + 
		(840*k1[10]*k2[7]*(k2[2] - q[2])*(k2[2] - q[2])*
		(-2*k3[4] - 7*k3[2]*q[2] + 9*q[4])*
		my_pow(1 - my_sqrt(k2[2]*k3[2] - 
		(-k1[2] + k2[2] + k3[2])*q[2] + q[4])/
		(k1[1]*q[1]),2))/
		(my_sqrt(k3[2]*(k2[2] - q[2]) + 
		q[2]*(k1[2] - k2[2] + q[2]))*
		my_pow(1 + my_sqrt(k2[2]*k3[2] - 
		(-k1[2] + k2[2] + k3[2])*q[2] + q[4])/
		(k1[1]*q[1]),2))))/(2.483712e7*k1[9]*k2[9]*q[5]);

	kernel_beta[1] = - (M_PI*(k1[2] - q[2])*(39*k1[12] + 
		165*my_pow(k2[2] - k3[2],3)*q[6] - 
		k1[10]*(582*k2[2] + 791*k3[2] + 1947*q[2]) - 
		3*k1[2]*(-k2[2] + k3[2])*q[4]*
		(85*k3[4] - 3*k2[2]*(186*k2[2] + 95*q[2]) + 
		k3[2]*(473*k2[2] + 153*q[2])) + 
		k1[8]*(51*k2[4] + 601*k3[4] + 6891*k2[2]*q[2] + 
		1689*q[4] + k3[2]*(2120*k2[2] + 1787*q[2])) + 
		k1[6]*(492*k2[6] + 151*k3[6] - 6465*k2[4]*q[2] - 
		7284*k2[2]*q[4] + 219*q[6] + 
		k3[4]*(390*k2[2] + 179*q[2]) + 
		k3[2]*(-633*k2[4] + 758*k2[2]*q[2] - 1113*q[4])) 
		+ k1[4]*q[2]*(1017*k2[6] + 269*k3[6] + 7269*k2[4]*q[2] + 
		471*k2[2]*q[4] + k3[4]*(391*k2[2] - 321*q[2]) + 
		k3[2]*(-1677*k2[4] - 4376*k2[2]*q[2] + 405*q[4])))
		*(k1[1]+q[1])*(k1[1]+q[1])*small_beta(k1[1], q[1]))/
		(1.655808e6*k1[9]*k2[2]*q[5]); 

	kernel_beta[2] = - (M_PI*(k2[2] - q[2])*
		(k3[6]*(151*k2[6] + 269*k2[4]*q[2] - 
		255*k2[2]*q[4] - 165*q[6]) + 
		k3[4]*(601*k2[8] + 179*k2[6]*q[2] - 
		321*k2[4]*q[4] - 459*k2[2]*q[6] + 
		k1[2]*(390*k2[6] + 391*k2[4]*q[2] - 
		1164*k2[2]*q[4] + 495*q[6])) + 
		k3[2]*(-791*k2[10] + 1787*k2[8]*q[2] - 
		1113*k2[6]*q[4] + 405*k2[4]*q[6] - 
		3*k1[4]*(211*k2[6] + 559*k2[4]*q[2] - 
		1031*k2[2]*q[4] + 165*q[6]) + 
		2*k1[2]*(1060*k2[8] + 379*k2[6]*q[2] - 
		2188*k2[4]*q[4] + 657*k2[2]*q[6])) + 
		3*(k1[6]*(164*k2[6] + 339*k2[4]*q[2] - 
		558*k2[2]*q[4] + 55*q[6]) + 
		k2[6]*(13*k2[6] - 649*k2[4]*q[2] + 
		563*k2[2]*q[4] + 73*q[6]) + 
		k1[4]*(17*k2[8] - 2155*k2[6]*q[2] + 
		2423*k2[4]*q[4] - 285*k2[2]*q[6]) + 
		k1[2]*(-194*k2[10] + 2297*k2[8]*q[2] - 
		2428*k2[6]*q[4] + 157*k2[4]*q[6])))*
		(k2[1]+q[1])*(k2[1]+q[1])*small_beta(k2[1], q[1]))/
		(1.655808e6*k1[2]*k2[9]*q[5]);

	kernel_beta[3] = (M_PI*(2*k3[2] + 9*q[2])*
		(-15*(k1[2] + k2[2])*k3[8] - 2*k3[10] - 
		3*(k1[2] - k2[2])*(k1[2] - k2[2])*q[4]*
		(k1[2] + k2[2] + 4*q[2]) + 
		2*k3[6]*(8*k1[4] + 8*k2[4] + 23*k2[2]*q[2] - 
		q[4] + k1[2]*(-16*k2[2] + 23*q[2])) + 
		k3[4]*(k1[6] + k2[6] - 56*k2[4]*q[2] - 
		47*k2[2]*q[4] + 4*q[6] - 
		k1[4]*(9*k2[2] + 56*q[2]) + 
		k1[2]*(-9*k2[4] + 136*k2[2]*q[2] - 47*q[4])) + 
		2*k3[2]*q[2]*(k1[6] + k2[6] + 26*k2[4]*q[2] + 
		4*k2[2]*q[4] - k1[4]*(k2[2] - 26*q[2]) - 
		k1[2]*(k2[4] + 48*k2[2]*q[2] - 4*q[4])))*
		(k3[1]+q[1])*(k3[1]+q[1])*small_beta(k3[1], q[1]))/
		(236544.*k1[2]*k2[2]*k3[5]*q[5]); 

	kernel_beta[4] = (3*k3[3]*M_PI*(k1[2] - q[2])*(k2[2] - q[2])* 
		big_beta(k1[1], k2[1], k3[1], q[1])) / (17248.*k1[2]*k2[2]*q[5]) - 
		(-k2[1]*M_PI*(2*k3[2] + 9*q[2])*(k1[2] - q[2])*
		big_beta(k1[1], k3[1], k2[1], q[1])) /(29568.*k1[2]*q[5]) - 
		(-k1[1]*M_PI*(2*k3[2] + 9*q[2])*(k2[2] - q[2])*
		big_beta(k2[1], k3[1], k1[1], q[1])) /(29568.*k2[2]*q[5]);

	size_t i;
	histo_t kernel_poly_sum = 0.;
	for (i=0;i<13;i++) kernel_poly_sum += kernel_poly[i]/(776160.*k1[5]*k2[5]*k3[1]*q[4]*my_pow((k1[1]+q[1])*(k2[1] + q[1])*(k3[1] + q[1]),4)*(k3[1] + q[1]));
	histo_t kernel_beta_sum = 0.;
	for (i=0;i<5;i++) kernel_beta_sum += kernel_beta[i];
	/*
	for (i=0;i<5;i++) {
		if (my_abs(kernel_beta[i])>1e5) printf("%d",(int)i);
	}
	*/
	return 4.*(kernel_poly_sum + kernel_beta_sum);
	
}


histo_t kernel_Gamma2d(histo_t k1,histo_t k2,histo_t k3,histo_t q)
{	
	if ((my_abs(k1/q-1.)<1.e-3)||(my_abs(k2/q-1.)<1.e-3)||(my_abs(k3/q-1.)<1.e-3)) return kernel_Gamma2d_reg3rd(k1, k2, k3, q);
	
	if (my_abs(k2/k1-1.)<2.e-2) {
		if (q>10.*MAX3(k1, k2, k3)) return kernel_Gamma2d_lowk(k1, k2, k3, q);
		if (q<0.1*MIN3(k1, k2, k3)) return kernel_Gamma2d_highk(k1, k2, k3, q);
		return kernel_Gamma2d_reg3rd(k1, k2, k3, q);
	}
	if (q<0.1*MIN3(k1, k2, k3)) return kernel_Gamma2d_highk(k1, k2, k3, q);
	if (q>10.*MAX3(k1, k2, k3)) return kernel_Gamma2d_lowk(k1, k2, k3, q);
	if ((q>50.*MIN(k1, k2))&&(my_abs(k1*k1-k3*k3)<q*q)) return kernel_Gamma2d_elongate(k1, k2, k3, q);
	if ((q>100.*k3)&&(k3<10.*MIN(k1,k2))) return kernel_Gamma2d_coll(k1, k2, k3, q);
	//if (isnan(kernel_Gamma2d_exact(k1, k2, k3, q))) printf("exact");
	//printf("exact");
	return kernel_Gamma2d_exact(k1, k2, k3, q);
}

static GaussLegendreQ gauss_legendre_q;
#pragma omp threadprivate(gauss_legendre_q)
static size_t nq_1loop = 100;
static INTERPOL interpol_q_1loop = POLY;

void set_precision_gamma2d(size_t nq_1loop_,char* interpol_q_1loop_)
{
	nq_1loop = nq_1loop_;
	interpol_q_1loop = get_interpol(interpol_q_1loop_);
}

void init_gamma2d()
{
	init_gauss_legendre_q(&gauss_legendre_q,nq_1loop,interpol_q_1loop,-1,-1);
}


void free_gamma2d()
{
	free_gauss_legendre_q(&gauss_legendre_q);
}

histo_t one_loop_Gamma2d(histo_t k1, histo_t k2, histo_t k3)
{
	//printf("%.3f %.3f %.3f ",k1,k2,k3);
	histo_t ss = 0.;
	size_t iq,nq=gauss_legendre_q.nq;
	for (iq=0;iq<nq;iq++) {
		histo_t q = gauss_legendre_q.q[iq];
		//printf("%.3f ",q);
		ss += gauss_legendre_q.w[iq] * kernel_Gamma2d(k1, k2, k3, q) * q*q*q * gauss_legendre_q.pk[iq];
		//if (isnan(kernel_Gamma2d(k1, k2, k3, q))) printf("%.6f %.6f %.6f %.6f\n",k1, k2, k3, q);
	}
	return ss / (8.*M_PI*M_PI*M_PI);
}

#endif //_REGPT_GAMMA2D_
